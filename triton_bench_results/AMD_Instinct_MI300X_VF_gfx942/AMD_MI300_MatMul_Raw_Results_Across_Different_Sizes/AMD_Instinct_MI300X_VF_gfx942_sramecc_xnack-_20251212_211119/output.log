INFO:__main__:Using config from TRITONBENCH_RUN_CONFIG: /home/hotaisle/KernelGeneration/benchmark_helion_runner.yaml
INFO:__main__:Expecting 3 output file(s):
INFO:__main__:  - bf16_layernorm: benchmark_bf16_layernorm.json
INFO:__main__:  - bf16_matmul: benchmark_bf16_matmul.json
INFO:__main__:  - bf16_gemm_gelu: benchmark_bf16_gemm_gelu.json
INFO:__main__:Cleared 1 TorchInductor cache directory
INFO:__main__:Starting benchmark run...
INFO:tritonbench.utils.run_utils:[tritonbench] Running helion benchmark: /home/hotaisle/KernelGeneration/myenv/bin/python benchmarks/run.py --device=cuda --precision bf16 --kernel-config ../custom_kernel_config.yaml --kernel bf16_layernorm --output benchmark_bf16_layernorm.json
Loading custom kernel configuration from: ../custom_kernel_config.yaml
Loaded 3 kernel mapping(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Loaded metric mappings for 3 kernel(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Using num_inputs=20 for bf16_layernorm
Running bf16_layernorm benchmark with Helion implementation...

WARNING:tritonbench.utils.triton_op:First-k mode: Selected 3 sequential inputs starting from index 0 (total available: 3)
WARNING:tritonbench.utils.triton_op:Input IDs to run: [0, 1, 2]
Using HIP autotune config
  0%|          | 0/3 [00:00<?, ?it/s]WARNING:tritonbench.utils.triton_op:Running input ID 0:
(M, D)
----------
(512, 512)
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_layernorm
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for triton_layernorm
INFO:tritonbench.utils.triton_op:Took 0.03ms to get benchmark function for kernelllm_layernorm
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_layernorm
INFO:tritonbench.utils.triton_op:Took 39.28ms to get benchmark function for torch_compile_max_layernorm
INFO:tritonbench.utils.triton_op:Took 1.24ms to get benchmark function for torch_compile_default_layernorm
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (512, 512),
              'stride': (512, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (512,),
              'stride': (1,)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (512,),
              'stride': (1,)},
            1e-05),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 0.53ms to get benchmark function for helion_layer_norm_tritonbench
[0s] Autotune random seed: 342337795
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━ 100/100 12.4         
                                                           configs/s    
Initial population exploring neighbors 100% ━━━━━━━━━ 100/100 18.3      
                                                              configs/s 
Verifying initial results 100% ━━━━━━━━━━━━━━━ 1000/1000 508.0 configs/s
[18s] Initial random population of 100, 5 starting points: error=18 ok=82 min=0.0059 mid=0.0116 max=0.2370 best=Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', 'last', 'last', ''], matrix_instr_nonkdim=0, num_stages=4, num_warps=8, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[18s] Generation 1 starting: 170 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━ 170/170 45.6 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━ 170/170 15.9         
                                                           configs/s    
Generation 1: verifying top configs 100% ━━━━━━━━━━ 1000/1000 101.4     
                                                              configs/s 
[48s] Generation 1 complete: ok=175 min=0.0060 mid=0.0063 max=0.0126 best=Config(block_sizes=[4], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer', 'pointer'], load_eviction_policies=['first', 'first', 'last', 'last'], matrix_instr_nonkdim=0, num_stages=6, num_warps=1, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[3], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[48s] Generation 2 starting: 124 neighbors, 4 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━ 124/124 37.7 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 124/124 15.9 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 140.0         
                                                                configs/s     
[71s] Generation 2 complete: ok=128 min=0.0062 mid=0.0066 max=0.0128 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', 'last', 'last'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[71s] Generation 3 starting: 122 neighbors, 4 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 122/122 40.4 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 122/122 15.8 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 141.6         
                                                                configs/s     
[93s] Generation 3 complete: ok=126 min=0.0062 mid=0.0064 max=0.0127 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['first', 'first', 'last', 'last'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[93s] Generation 4 starting: 118 neighbors, 4 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 34.1 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 118/118 15.9 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 146.6         
                                                                configs/s     
[114s] Generation 4 complete: ok=122 min=0.0061 mid=0.0063 max=0.0131 best=Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', '', '', ''], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[114s] Generation 5 starting: 118 neighbors, 4 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 49.7 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 118/118 15.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.5         
                                                                configs/s     
[135s] Generation 5 complete: ok=122 min=0.0061 mid=0.0065 max=0.0131 best=Config(block_sizes=[4], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', 'last', 'first', ''], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[2], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[135s] Generation 6 starting: 120 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 120/120 38.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 120/120 15.9 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 141.7         
                                                                configs/s     
[156s] Generation 6 complete: ok=124 min=0.0061 mid=0.0064 max=0.0131 best=Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', '', '', 'last'], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[156s] Generation 7 starting: 119 neighbors, 4 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 119/119 36.1 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 119/119 15.9 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.2         
                                                                configs/s     
[178s] Generation 7 complete: ok=123 min=0.0061 mid=0.0064 max=0.0129 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['last', 'last', '', 'first'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[178s] Generation 8 starting: 120 neighbors, 4 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 120/120 35.5 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 120/120 16.0 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.5         
                                                                configs/s     
[199s] Generation 8 complete: ok=124 min=0.0061 mid=0.0063 max=0.0131 best=Config(block_sizes=[4], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', 'last', 'first', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[199s] Generation 9 starting: 119 neighbors, 4 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 119/119 32.0 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 119/119 15.8 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.2         
                                                                configs/s     
[221s] Generation 9 complete: ok=123 min=0.0061 mid=0.0063 max=0.0129 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['last', 'first', 'last', 'last'], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[221s] Generation 10 starting: 120 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 120/120 44.6 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 120/120 15.8 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 145.3        
                                                                 configs/s    
[243s] Generation 10 complete: ok=124 min=0.0062 mid=0.0063 max=0.0128 best=Config(block_sizes=[4], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', 'first', 'first', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[243s] Generation 11 starting: 122 neighbors, 4 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 122/122 46.0 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 15.3 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 142.1        
                                                                 configs/s    
[265s] Generation 11 complete: ok=126 min=0.0061 mid=0.0064 max=0.0105 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['first', 'first', '', 'first'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[265s] Generation 12 starting: 121 neighbors, 4 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 121/121 44.9 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 15.9 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 142.7        
                                                                 configs/s    
[287s] Generation 12 complete: ok=125 min=0.0061 mid=0.0063 max=0.0132 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['first', 'first', 'first', 'first'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[287s] Generation 13 starting: 122 neighbors, 4 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 122/122 43.2 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 15.8 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 142.8        
                                                                 configs/s    
[309s] Generation 13 complete: ok=126 min=0.0060 mid=0.0064 max=0.0132 best=Config(block_sizes=[4], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', 'first', '', 'last'], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[309s] Generation 14 starting: 87 neighbors, 3 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 87/87 38.0 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 87/87 15.8 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 197.3        
                                                                 configs/s    
[325s] Generation 14 complete: ok=90 min=0.0061 mid=0.0063 max=0.0121 best=Config(block_sizes=[4], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', 'first', 'first', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
[325s] Generation 15 starting: 61 neighbors, 2 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 61/61 61.7 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 61/61 14.9 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 281.5        
                                                                 configs/s    
[336s] Generation 15 complete: ok=64 min=0.0062 mid=0.0063 max=0.0106 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[336s] Generation 16 starting: 56 neighbors, 2 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 56/56 29.6 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 56/56 16.0 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 313.5        
                                                                 configs/s    
[346s] Generation 16 complete: ok=58 min=0.0062 mid=0.0064 max=0.0115 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', 'first', 'first'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[346s] Generation 17 starting: 29 neighbors, 1 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 29/29 76.6 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 29/29 16.3 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 595.2        
                                                                 configs/s    
[351s] Generation 17 complete: ok=31 min=0.0063 mid=0.0063 max=0.0104 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[351s] Generation 18 starting: 30 neighbors, 1 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 30/30 21.3 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 30/30 16.1 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 602.7        
                                                                 configs/s    
[357s] Generation 18 complete: ok=31 min=0.0063 mid=0.0063 max=0.0112 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[357s] Autotuning complete in 357.8s after searching 1978 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[8], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['first', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=6, num_warps=2, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 0:
(M, D)
----------
(512, 512)
 33%|███▎      | 1/3 [06:01<12:03, 361.96s/it]WARNING:tritonbench.utils.triton_op:Running input ID 1:
(M, D)
----------
(32, 1024)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_layernorm
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for triton_layernorm
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for kernelllm_layernorm
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_layernorm
INFO:tritonbench.utils.triton_op:Took 2.42ms to get benchmark function for torch_compile_max_layernorm
INFO:tritonbench.utils.triton_op:Took 1.24ms to get benchmark function for torch_compile_default_layernorm
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (32, 1024),
              'stride': (1024, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1024,),
              'stride': (1,)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1024,),
              'stride': (1,)},
            1e-05),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 3.65ms to get benchmark function for helion_layer_norm_tritonbench
[0s] Autotune random seed: 342337795
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━ 100/100 30.9 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 19.1         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━━ 1000/1000 407.3 configs/s
[14s] Initial random population of 100, 5 starting points: error=16 ok=84 min=0.0061 mid=0.0096 max=0.0546 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[14s] Generation 1 starting: 151 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 151/151 41.9 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 151/151 15.4 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.1         
                                                                configs/s     
[41s] Generation 1 complete: ok=156 min=0.0062 mid=0.0064 max=0.0108 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', 'first', 'last'], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[41s] Generation 2 starting: 147 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 147/147 41.3 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 147/147 15.7 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.7         
                                                                configs/s     
[68s] Generation 2 complete: ok=152 min=0.0061 mid=0.0063 max=0.0104 best=Config(block_sizes=[4], indexing=['tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', 'first', 'first'], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_blocked', range_flattens=[True], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[2], range_warp_specializes=[], reduction_loops=[512], waves_per_eu=1)
[68s] Generation 3 starting: 148 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 148/148 39.7 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 148/148 15.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.1         
                                                                configs/s     
[95s] Generation 3 complete: ok=153 min=0.0061 mid=0.0063 max=0.0102 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', '', '', 'last'], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[95s] Generation 4 starting: 144 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 144/144 39.3 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 144/144 15.8 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.1         
                                                                configs/s     
[120s] Generation 4 complete: ok=149 min=0.0060 mid=0.0063 max=0.0113 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', '', 'first', 'last'], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[120s] Generation 5 starting: 145 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 145/145 40.3 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 145/145 15.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.5         
                                                                configs/s     
[147s] Generation 5 complete: ok=150 min=0.0060 mid=0.0063 max=0.0118 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', 'first', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512], waves_per_eu=1)
[147s] Generation 6 starting: 145 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 145/145 47.1 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 145/145 15.3 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 116.5         
                                                                configs/s     
[172s] Generation 6 complete: ok=150 min=0.0060 mid=0.0063 max=0.0115 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512], waves_per_eu=1)
[173s] Generation 7 starting: 144 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 144/144 39.5 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 144/144 15.8 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 116.5         
                                                                configs/s     
[199s] Generation 7 complete: ok=149 min=0.0061 mid=0.0064 max=0.0116 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512], waves_per_eu=1)
[199s] Generation 8 starting: 139 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 139/139 38.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 139/139 15.8 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 122.4         
                                                                configs/s     
[224s] Generation 8 complete: ok=144 min=0.0061 mid=0.0064 max=0.0181 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['first', 'first', 'last', ''], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[224s] Generation 9 starting: 142 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 142/142 40.9 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 142/142 15.8 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 119.0         
                                                                configs/s     
[249s] Generation 9 complete: ok=147 min=0.0060 mid=0.0064 max=0.0109 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[512], waves_per_eu=1)
[249s] Generation 10 starting: 124 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 124/124 38.7 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 124/124 15.8 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 136.4        
                                                                 configs/s    
[272s] Generation 10 complete: ok=129 min=0.0061 mid=0.0064 max=0.0112 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', 'first', 'last'], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[272s] Generation 11 starting: 121 neighbors, 4 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 121/121 46.2 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 15.7 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 139.8        
                                                                 configs/s    
[293s] Generation 11 complete: ok=125 min=0.0060 mid=0.0064 max=0.0120 best=Config(block_sizes=[8], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['last', 'last', 'last', ''], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None], range_multi_buffers=[True], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[293s] Generation 12 starting: 114 neighbors, 4 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 114/114 40.6 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 114/114 15.6 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 148.8        
                                                                 configs/s    
[313s] Generation 12 complete: ok=118 min=0.0061 mid=0.0063 max=0.0119 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[314s] Generation 13 starting: 117 neighbors, 4 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 117/117 42.3 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 15.8 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 145.1        
                                                                 configs/s    
[334s] Generation 13 complete: ok=121 min=0.0060 mid=0.0063 max=0.0108 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[334s] Generation 14 starting: 114 neighbors, 4 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 114/114 39.0 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 114/114 15.7 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 147.6        
                                                                 configs/s    
[355s] Generation 14 complete: ok=118 min=0.0060 mid=0.0064 max=0.0109 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[3], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[355s] Generation 15 starting: 117 neighbors, 4 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 117/117 41.0 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 15.7 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.1        
                                                                 configs/s    
[375s] Generation 15 complete: ok=121 min=0.0060 mid=0.0063 max=0.0110 best=Config(block_sizes=[2], indexing=['pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', 'first', 'first', 'first'], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_blocked', range_flattens=[True], range_multi_buffers=[True], range_num_stages=[1], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[375s] Generation 16 starting: 116 neighbors, 4 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 116/116 40.2 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 116/116 15.6 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 145.2        
                                                                 configs/s    
[396s] Generation 16 complete: ok=120 min=0.0060 mid=0.0063 max=0.0120 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', '', 'first', ''], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[3], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[396s] Generation 17 starting: 113 neighbors, 4 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 113/113 39.4 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 113/113 14.9 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 149.3        
                                                                 configs/s    
[416s] Generation 17 complete: ok=117 min=0.0060 mid=0.0063 max=0.0130 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', 'last', 'first', ''], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[3], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[416s] Generation 18 starting: 110 neighbors, 4 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 110/110 39.0 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 110/110 15.7 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 153.0        
                                                                 configs/s    
[436s] Generation 18 complete: ok=114 min=0.0061 mid=0.0064 max=0.0125 best=Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'first', 'last', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[436s] Generation 19 starting: 114 neighbors, 4 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 114/114 45.1 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 114/114 15.6 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 147.4        
                                                                 configs/s    
[456s] Generation 19 complete: ok=118 min=0.0060 mid=0.0064 max=0.0117 best=Config(block_sizes=[2], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', 'last', 'first', 'first'], matrix_instr_nonkdim=0, num_stages=8, num_warps=4, pid_type='persistent_blocked', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[3], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[456s] Generation 20 starting: 115 neighbors, 4 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 115/115 45.4 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 115/115 15.6 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 147.4        
                                                                 configs/s    
[476s] Generation 20 complete: ok=119 min=0.0061 mid=0.0063 max=0.0117 best=Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'last', '', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[476s] Autotuning complete in 476.7s after searching 2680 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[2], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', 'last', '', ''], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[1], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 1:
(M, D)
----------
(32, 1024)
 67%|██████▋   | 2/3 [14:03<07:12, 432.11s/it]WARNING:tritonbench.utils.triton_op:Running input ID 2:
(M, D)
------------
(2048, 2048)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_layernorm
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for triton_layernorm
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for kernelllm_layernorm
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_layernorm
INFO:tritonbench.utils.triton_op:Took 2.40ms to get benchmark function for torch_compile_max_layernorm
INFO:tritonbench.utils.triton_op:Took 1.25ms to get benchmark function for torch_compile_default_layernorm
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2048, 2048),
              'stride': (2048, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2048,),
              'stride': (1,)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2048,),
              'stride': (1,)},
            1e-05),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 4.47ms to get benchmark function for helion_layer_norm_tritonbench
[0s] Autotune random seed: 342337795
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[63s] Timeout after 60s compiling Config(block_sizes=[1024], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['last', 'first', '', 'first'], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[True], range_num_stages=[3], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[32], waves_per_eu=1)
[63s] Timeout after 60s compiling Config(block_sizes=[1024], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'pointer'], load_eviction_policies=['last', '', 'last', 'first'], matrix_instr_nonkdim=0, num_stages=1, num_warps=1, pid_type='persistent_interleaved', range_flattens=[False], range_multi_buffers=[False], range_num_stages=[0], range_unroll_factors=[4], range_warp_specializes=[], reduction_loops=[64], waves_per_eu=1)
[63s] Timeout after 60s compiling Config(block_sizes=[512], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', 'first', '', ''], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='persistent_interleaved', range_flattens=[True], range_multi_buffers=[None], range_num_stages=[2], range_unroll_factors=[1], range_warp_specializes=[], reduction_loops=[256], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 2.8 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 20.1         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 1174.3 configs/s
[69s] Initial random population of 100, 5 starting points: error=20 timeout=3 ok=77 min=0.0098 mid=0.0326 max=2.1585 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[69s] Generation 1 starting: 130 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 130/130 38.3 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 130/130 16.5 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 145.9         
                                                                configs/s     
[92s] Generation 1 complete: error=2 ok=133 min=0.0095 mid=0.0115 max=0.0162 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[92s] Generation 2 starting: 113 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 113/113 37.5 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 113/113 16.8 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 166.2         
                                                                configs/s     
[113s] Generation 2 complete: error=2 ok=116 min=0.0100 mid=0.0114 max=0.0147 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[113s] Generation 3 starting: 118 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 42.9 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 118/118 16.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 159.9         
                                                                configs/s     
[133s] Generation 3 complete: error=2 ok=121 min=0.0099 mid=0.0115 max=0.0164 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[133s] Generation 4 starting: 117 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 117/117 42.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 117/117 16.9 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 161.3         
                                                                configs/s     
[153s] Generation 4 complete: error=2 ok=120 min=0.0100 mid=0.0115 max=0.0151 best=Config(block_sizes=[1], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[153s] Generation 5 starting: 115 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 115/115 42.7 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 115/115 16.9 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 164.2         
                                                                configs/s     
[173s] Generation 5 complete: error=2 ok=118 min=0.0100 mid=0.0116 max=0.0179 best=Config(block_sizes=[1], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[173s] Generation 6 starting: 116 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 116/116 43.5 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 116/116 16.9 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 162.5         
                                                                configs/s     
[192s] Generation 6 complete: error=2 ok=119 min=0.0099 mid=0.0115 max=0.0158 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[192s] Generation 7 starting: 115 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 115/115 43.0 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 115/115 16.9 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 163.8         
                                                                configs/s     
[212s] Generation 7 complete: error=2 ok=118 min=0.0100 mid=0.0116 max=0.0152 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[212s] Generation 8 starting: 109 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 109/109 42.9 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 109/109 16.9 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 174.3         
                                                                configs/s     
[231s] Generation 8 complete: error=2 ok=112 min=0.0097 mid=0.0113 max=0.0155 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[231s] Generation 9 starting: 111 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 111/111 43.2 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 111/111 16.9 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 170.4         
                                                                configs/s     
[250s] Generation 9 complete: error=2 ok=114 min=0.0098 mid=0.0115 max=0.0163 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[250s] Generation 10 starting: 111 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 111/111 44.3 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 111/111 16.9 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 171.2        
                                                                 configs/s    
[269s] Generation 10 complete: error=2 ok=114 min=0.0097 mid=0.0113 max=0.0146 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[269s] Generation 11 starting: 111 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 111/111 44.3 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 111/111 16.9 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 170.2        
                                                                 configs/s    
[288s] Generation 11 complete: error=2 ok=114 min=0.0100 mid=0.0116 max=0.0143 best=Config(block_sizes=[1], indexing=['pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[288s] Generation 12 starting: 112 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 112/112 44.3 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 112/112 16.9 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 168.5        
                                                                 configs/s    
[307s] Generation 12 complete: error=2 ok=115 min=0.0101 mid=0.0116 max=0.0155 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[307s] Generation 13 starting: 111 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 111/111 45.5 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 111/111 17.0 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 171.0        
                                                                 configs/s    
[326s] Generation 13 complete: error=2 ok=114 min=0.0098 mid=0.0114 max=0.0159 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[326s] Generation 14 starting: 107 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 107/107 37.4 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 107/107 17.0 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 177.8        
                                                                 configs/s    
[345s] Generation 14 complete: error=2 ok=110 min=0.0099 mid=0.0115 max=0.0151 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[345s] Generation 15 starting: 111 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 111/111 37.9 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 111/111 17.0 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 170.4        
                                                                 configs/s    
[364s] Generation 15 complete: error=2 ok=114 min=0.0099 mid=0.0115 max=0.0147 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[364s] Generation 16 starting: 110 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 110/110 37.9 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 110/110 17.0 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 172.0        
                                                                 configs/s    
[383s] Generation 16 complete: error=2 ok=113 min=0.0100 mid=0.0116 max=0.0148 best=Config(block_sizes=[1], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[383s] Generation 17 starting: 108 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 108/108 37.7 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 108/108 17.0 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 175.3        
                                                                 configs/s    
[402s] Generation 17 complete: error=2 ok=111 min=0.0101 mid=0.0116 max=0.0156 best=Config(block_sizes=[1], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[402s] Generation 18 starting: 109 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 109/109 37.8 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 109/109 17.0 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 174.5        
                                                                 configs/s    
[421s] Generation 18 complete: error=2 ok=112 min=0.0097 mid=0.0114 max=0.0157 best=Config(block_sizes=[1], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[421s] Generation 19 starting: 110 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 110/110 37.3 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 110/110 17.0 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 172.4        
                                                                 configs/s    
[441s] Generation 19 complete: error=2 ok=113 min=0.0097 mid=0.0114 max=0.0146 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'tensor_descriptor', 'pointer', 'tensor_descriptor', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[441s] Generation 20 starting: 106 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 106/106 37.5 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 106/106 17.0 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 179.9        
                                                                 configs/s    
[459s] Generation 20 complete: error=2 ok=109 min=0.0097 mid=0.0113 max=0.0150 best=Config(block_sizes=[1], indexing=['pointer', 'pointer', 'tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1)
[459s] Autotuning complete in 459.7s after searching 2347 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1], indexing=['pointer', 'pointer', 'tensor_descriptor', 'pointer', 'pointer', 'tensor_descriptor'], load_eviction_policies=['', '', '', ''], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None], range_multi_buffers=[None], range_num_stages=[0], range_unroll_factors=[0], range_warp_specializes=[], reduction_loops=[None], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 2:
(M, D)
------------
(2048, 2048)
100%|██████████| 3/3 [21:48<00:00, 447.26s/it]100%|██████████| 3/3 [21:48<00:00, 436.15s/it]
INFO:tritonbench.utils.run_utils:[tritonbench] Output result csv to /tmp/tmp2yw00oq7.csv
INFO:__main__:ignoring torch_layernorm-latency
INFO:__main__:ignoring torch_layernorm-best_config
INFO:__main__:ignoring torch_layernorm-gbps
INFO:__main__:ignoring triton_layernorm-best_config
INFO:__main__:ignoring kernelllm_layernorm-best_config
INFO:__main__:ignoring mako_layernorm-best_config
INFO:__main__:ignoring torch_compile_max_layernorm-best_config
INFO:__main__:ignoring torch_compile_default_layernorm-best_config
INFO:__main__:ignoring helion_layer_norm_tritonbench-best_config
INFO:__main__:ignoring torch_layernorm-latency
INFO:__main__:ignoring torch_layernorm-best_config
INFO:__main__:ignoring torch_layernorm-gbps
INFO:__main__:ignoring triton_layernorm-best_config
INFO:__main__:ignoring kernelllm_layernorm-best_config
INFO:__main__:ignoring mako_layernorm-best_config
INFO:__main__:ignoring torch_compile_max_layernorm-best_config
INFO:__main__:ignoring torch_compile_default_layernorm-best_config
INFO:__main__:ignoring helion_layer_norm_tritonbench-best_config
INFO:__main__:ignoring torch_layernorm-latency
INFO:__main__:ignoring torch_layernorm-best_config
INFO:__main__:ignoring torch_layernorm-gbps
INFO:__main__:ignoring triton_layernorm-best_config
INFO:__main__:ignoring kernelllm_layernorm-best_config
INFO:__main__:ignoring mako_layernorm-best_config
INFO:__main__:ignoring torch_compile_max_layernorm-best_config
INFO:__main__:ignoring torch_compile_default_layernorm-best_config
INFO:__main__:ignoring helion_layer_norm_tritonbench-best_config
      (M, D)    torch_layernorm-latency    torch_layernorm-best_config    torch_layernorm-gbps    triton_layernorm-latency    triton_layernorm-accuracy                                         triton_layernorm-best_config    triton_layernorm-gbps    kernelllm_layernorm-latency    kernelllm_layernorm-accuracy    kernelllm_layernorm-best_config    kernelllm_layernorm-gbps    mako_layernorm-latency    mako_layernorm-accuracy    mako_layernorm-best_config    mako_layernorm-gbps    torch_compile_max_layernorm-latency    torch_compile_max_layernorm-accuracy    torch_compile_max_layernorm-best_config    torch_compile_max_layernorm-gbps    torch_compile_default_layernorm-latency    torch_compile_default_layernorm-accuracy    torch_compile_default_layernorm-best_config    torch_compile_default_layernorm-gbps    helion_layer_norm_tritonbench-latency    helion_layer_norm_tritonbench-accuracy    helion_layer_norm_tritonbench-best_config    helion_layer_norm_tritonbench-gbps
------------  -------------------------  -----------------------------  ----------------------  --------------------------  ---------------------------  -------------------------------------------------------------------  -----------------------  -----------------------------  ------------------------------  ---------------------------------  --------------------------  ------------------------  -------------------------  ----------------------------  ---------------------  -------------------------------------  --------------------------------------  -----------------------------------------  ----------------------------------  -----------------------------------------  ------------------------------------------  ---------------------------------------------  --------------------------------------  ---------------------------------------  ----------------------------------------  -------------------------------------------  ------------------------------------
  (512, 512)          0.006615 (±9.10%)                                                158.515          0.044341 (±14.10%)                            1  {'BLOCK_SIZE': 512, 'num_warps': 8, 'num_ctas': 1, 'num_stages': 2}                 23.648               0.047628 (±20.96%)                               1                                                       22.016          0.013471 (±41.07%)                          1                                             77.8395                       0.159361 (±2.29%)                                       1                                                                       6.57988                           0.090004 (±9.98%)                                           1                                                                               11.6503                        0.047588 (±13.56%)                                         1                                                                           22.0345
  (32, 1024)         0.006534 (±17.19%)                                                 20.06           0.046987 (±11.35%)                            1  {'BLOCK_SIZE': 512, 'num_warps': 8, 'num_ctas': 1, 'num_stages': 2}                  2.78954             0.054203 (±11.91%)                               1                                                        2.41817        0.016919 (±27.25%)                          1                                              7.74703                    0.425045 (±858.68%)                                       1                                                                       0.308372                          0.092289 (±9.21%)                                           1                                                                                1.42023                       0.047989 (±11.70%)                                         1                                                                            2.73129
(2048, 2048)          0.014513 (±8.56%)                                               1156.01           0.047548 (±12.40%)                            1  {'BLOCK_SIZE': 256, 'num_warps': 4, 'num_ctas': 1, 'num_stages': 2}                352.848               0.052960 (±13.93%)                               1                                                      316.79           0.014994 (±37.43%)                          1                                           1118.93                       0.397101 (±927.77%)                                       1                                                                      42.2492                            0.092410 (±9.11%)                                           1                                                                              181.552                         0.041735 (±14.22%)                                         1                                                                          401.994
     average       0.009220666562517485                                                444.863         0.04629200076063474                            1                                                                                     126.429              0.05159700041015943                               1                                                      113.741        0.015128000018497309                          1                                            401.505                        0.327169011036555                                       1                                                                      16.3792                          0.09156766533851624                                           1                                                                               64.8742                       0.04577066625157992                                         1                                                                          142.253
INFO:tritonbench.utils.run_utils:[tritonbench] Running helion benchmark: /home/hotaisle/KernelGeneration/myenv/bin/python benchmarks/run.py --device=cuda --precision bf16 --kernel-config ../custom_kernel_config.yaml --kernel bf16_matmul --output benchmark_bf16_matmul.json
Loading custom kernel configuration from: ../custom_kernel_config.yaml
Loaded 3 kernel mapping(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Loaded metric mappings for 3 kernel(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Using num_inputs=20 for bf16_matmul
Running bf16_matmul benchmark with Helion implementation...

WARNING:tritonbench.utils.triton_op:First-k mode: Selected 20 sequential inputs starting from index 0 (total available: 30)
WARNING:tritonbench.utils.triton_op:Input IDs to run: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Using HIP autotune config
Using HIP autotune config
Using HIP autotune config
  0%|          | 0/20 [00:00<?, ?it/s]WARNING:tritonbench.utils.triton_op:Running input ID 0:
(M, K, N)
---------------
(256, 384, 512)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.03ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_4", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4", "best_time": 0.011105000041425228, "best_triton_pos": 0}
AUTOTUNE mm(256x384, 384x512)
strides: [384, 1], [512, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_4 0.0111 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_1 0.0113 ms 97.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=32, BLOCK_N=16, EVEN_K=False, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
  triton_mm_18 0.0113 ms 97.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_9 0.0115 ms 96.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_15 0.0116 ms 95.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_10 0.0117 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_8 0.0117 ms 94.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_19 0.0121 ms 92.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_3 0.0122 ms 90.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=32, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_14 0.0124 ms 89.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.2495 seconds and 1.3574 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2837.03ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 58.18ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (256, 384),
              'stride': (384, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (384, 512),
              'stride': (512, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 0.53ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 21.7         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 3314.2 configs/s
[52s] Initial random population of 100, 5 starting points: error=29 ok=71 min=0.0084 mid=0.0342 max=10.5809 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[None, True], range_num_stages=[3, 4], range_unroll_factors=[2, 2], range_warp_specializes=[], waves_per_eu=1)
[52s] Generation 1 starting: 231 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 231/231 14.4 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 231/231 18.0 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 194.6         
                                                                configs/s     
[91s] Generation 1 complete: error=19 ok=217 min=0.0083 mid=0.0123 max=0.1740 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[None, True], range_num_stages=[3, 4], range_unroll_factors=[2, 2], range_warp_specializes=[], waves_per_eu=1)
[91s] Generation 2 starting: 214 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 214/214 10.3 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 214/214 18.0 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 99.5         
                                                                 configs/s    
[138s] Generation 2 complete: error=19 ok=200 min=0.0077 mid=0.0100 max=0.1048 best=Config(block_sizes=[16, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=7, num_warps=8, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[False, None], range_num_stages=[2, 3], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[138s] Generation 3 starting: 211 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 211/211 25.2 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 211/211 17.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 100.3         
                                                                configs/s     
[172s] Generation 3 complete: error=19 ok=197 min=0.0077 mid=0.0093 max=0.1050 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[172s] Generation 4 starting: 220 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 220/220 31.7 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 220/220 17.8 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 97.9         
                                                                 configs/s    
[207s] Generation 4 complete: error=19 ok=206 min=0.0077 mid=0.0093 max=0.1020 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[207s] Generation 5 starting: 223 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 223/223 34.5 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 17.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 95.0         
                                                                 configs/s    
[241s] Generation 5 complete: error=18 ok=210 min=0.0079 mid=0.0094 max=0.1020 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[241s] Generation 6 starting: 219 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 219/219 35.1 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 219/219 17.4 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 97.3         
                                                                 configs/s    
[274s] Generation 6 complete: error=18 ok=206 min=0.0079 mid=0.0093 max=0.1020 best=Config(block_sizes=[16, 32, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[2, 1], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[274s] Generation 7 starting: 220 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 220/220 34.3 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 220/220 17.4 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 98.4         
                                                                 configs/s    
[308s] Generation 7 complete: error=18 ok=207 min=0.0078 mid=0.0093 max=0.1022 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[308s] Generation 8 starting: 211 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 211/211 32.6 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 211/211 17.4 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 100.7         
                                                                configs/s     
[341s] Generation 8 complete: error=17 ok=199 min=0.0076 mid=0.0087 max=0.1021 best=Config(block_sizes=[16, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[None, True], range_num_stages=[4, 1], range_unroll_factors=[2, 2], range_warp_specializes=[], waves_per_eu=1)
[341s] Generation 9 starting: 214 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 214/214 33.1 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 214/214 17.3 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 101.7         
                                                                configs/s     
[374s] Generation 9 complete: error=17 ok=202 min=0.0077 mid=0.0091 max=0.1020 best=Config(block_sizes=[16, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[None, True], range_num_stages=[4, 1], range_unroll_factors=[2, 2], range_warp_specializes=[], waves_per_eu=1)
[374s] Generation 10 starting: 207 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 207/207 24.8 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 207/207 17.7 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 103.9        
                                                                 configs/s    
[408s] Generation 10 complete: error=17 ok=195 min=0.0077 mid=0.0089 max=0.1019 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[4, 2], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[408s] Generation 11 starting: 216 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 216/216 25.0 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 216/216 17.7 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 101.0        
                                                                 configs/s    
[443s] Generation 11 complete: error=17 ok=204 min=0.0076 mid=0.0088 max=0.1020 best=Config(block_sizes=[16, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[None, True], range_num_stages=[3, 2], range_unroll_factors=[2, 2], range_warp_specializes=[], waves_per_eu=1)
[443s] Generation 12 starting: 212 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 212/212 19.6 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 212/212 16.7 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 94.9         
                                                                 configs/s    
[482s] Generation 12 complete: error=8 ok=209 min=0.0075 mid=0.0089 max=0.1041 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[4, 3], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[482s] Generation 13 starting: 219 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 219/219 24.6 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 219/219 16.3 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 92.4         
                                                                 configs/s    
[520s] Generation 13 complete: error=7 ok=217 min=0.0072 mid=0.0087 max=0.1042 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[4, 4], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[520s] Generation 14 starting: 220 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 220/220 24.6 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 220/220 16.3 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 93.2         
                                                                 configs/s    
[557s] Generation 14 complete: error=7 ok=218 min=0.0073 mid=0.0088 max=0.1041 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[557s] Generation 15 starting: 219 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 219/219 29.2 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 219/219 16.6 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 95.1         
                                                                 configs/s    
[593s] Generation 15 complete: error=7 ok=217 min=0.0074 mid=0.0088 max=0.1043 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[3, 4], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[593s] Generation 16 starting: 218 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 218/218 26.3 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 218/218 16.7 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 95.0         
                                                                 configs/s    
[630s] Generation 16 complete: error=8 ok=215 min=0.0076 mid=0.0092 max=0.1053 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[3, 3], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[630s] Generation 17 starting: 218 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 218/218 29.0 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 218/218 16.8 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 96.8         
                                                                 configs/s    
[665s] Generation 17 complete: error=8 ok=215 min=0.0073 mid=0.0088 max=0.1052 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[3, 2], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[665s] Generation 18 starting: 216 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 216/216 24.0 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 216/216 16.8 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 97.7         
                                                                 configs/s    
[702s] Generation 18 complete: error=8 ok=213 min=0.0073 mid=0.0089 max=0.1049 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[3, 1], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[702s] Generation 19 starting: 222 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 222/222 24.2 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 222/222 16.9 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 94.4         
                                                                 configs/s    
[739s] Generation 19 complete: error=8 ok=219 min=0.0072 mid=0.0089 max=0.1049 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='persistent_interleaved', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[4, 1], range_unroll_factors=[3, 4], range_warp_specializes=[], waves_per_eu=1)
[739s] Generation 20 starting: 211 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 211/211 32.0 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 211/211 16.8 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 99.7         
                                                                 configs/s    
[773s] Generation 20 complete: error=8 ok=208 min=0.0082 mid=0.0093 max=0.1048 best=Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[773s] Autotuning complete in 773.4s after searching 4441 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[32, 16, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 0:
(M, K, N)
---------------
(256, 384, 512)
  5%|▌         | 1/20 [13:02<4:07:55, 782.91s/it]WARNING:tritonbench.utils.triton_op:Running input ID 1:
(M, K, N)
---------------
(384, 512, 640)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_39", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=32, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4", "best_time": 0.010785000398755074, "best_triton_pos": 0}
AUTOTUNE mm(384x512, 512x640)
strides: [512, 1], [640, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_39 0.0108 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=32, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_45 0.0109 ms 98.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_46 0.0113 ms 95.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_58 0.0114 ms 94.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_43 0.0115 ms 94.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_56 0.0117 ms 91.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_48 0.0119 ms 90.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_53 0.0119 ms 90.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_50 0.0123 ms 87.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_51 0.0134 ms 80.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.3678 seconds and 1.1300 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1974.07ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 56.17ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (384, 512),
              'stride': (512, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (512, 640),
              'stride': (640, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 7.31ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 8.9 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 21.6         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 3207.1 configs/s
[17s] Initial random population of 100, 5 starting points: error=27 ok=73 min=0.0105 mid=0.0596 max=12.7888 best=Config(block_sizes=[16, 16, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[1], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=1, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[17s] Generation 1 starting: 200 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 27.8 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 16.8 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 179.2         
                                                                configs/s     
[45s] Generation 1 complete: error=7 ok=198 min=0.0097 mid=0.0147 max=0.0773 best=Config(block_sizes=[16, 16, 64], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[1], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=1, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[45s] Generation 2 starting: 183 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 183/183 27.3 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 183/183 16.7 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 118.9         
                                                                configs/s     
[76s] Generation 2 complete: error=8 ok=180 min=0.0089 mid=0.0112 max=0.0769 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[76s] Generation 3 starting: 188 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 188/188 23.7 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 188/188 16.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 121.3         
                                                                configs/s     
[107s] Generation 3 complete: error=6 ok=187 min=0.0083 mid=0.0107 max=0.0768 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[107s] Generation 4 starting: 200 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 30.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 17.8 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.9         
                                                                configs/s     
[137s] Generation 4 complete: error=15 ok=190 min=0.0088 mid=0.0105 max=0.1325 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[False, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[137s] Generation 5 starting: 198 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 198/198 26.3 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 17.1 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.0         
                                                                configs/s     
[169s] Generation 5 complete: error=15 ok=188 min=0.0086 mid=0.0102 max=0.1323 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[False, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[169s] Generation 6 starting: 201 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 201/201 26.8 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 201/201 17.4 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.3         
                                                                configs/s     
[201s] Generation 6 complete: error=15 ok=191 min=0.0084 mid=0.0103 max=0.1057 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[False, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[201s] Generation 7 starting: 193 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 193/193 28.0 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 193/193 17.6 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 119.0         
                                                                configs/s     
[232s] Generation 7 complete: error=16 ok=182 min=0.0087 mid=0.0103 max=0.1087 best=Config(block_sizes=[16, 32, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[232s] Generation 8 starting: 200 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 25.8 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 17.5 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.3         
                                                                configs/s     
[265s] Generation 8 complete: error=16 ok=189 min=0.0083 mid=0.0098 max=0.1090 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, None], range_multi_buffers=[False, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[265s] Generation 9 starting: 199 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 199/199 28.2 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 199/199 17.4 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.2         
                                                                configs/s     
[296s] Generation 9 complete: error=16 ok=188 min=0.0088 mid=0.0099 max=0.1088 best=Config(block_sizes=[16, 32, 64], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[1], load_eviction_policies=['', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[296s] Generation 10 starting: 198 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 198/198 26.0 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 198/198 17.5 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.9        
                                                                 configs/s    
[328s] Generation 10 complete: error=16 ok=187 min=0.0086 mid=0.0098 max=0.1088 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, None], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[328s] Generation 11 starting: 194 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 194/194 27.9 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 194/194 17.6 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 119.7        
                                                                 configs/s    
[359s] Generation 11 complete: error=16 ok=183 min=0.0089 mid=0.0104 max=0.1090 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[359s] Generation 12 starting: 197 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 197/197 25.5 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 16.9 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 120.8        
                                                                 configs/s    
[390s] Generation 12 complete: error=16 ok=186 min=0.0083 mid=0.0097 max=0.1059 best=Config(block_sizes=[16, 32, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[390s] Generation 13 starting: 189 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 189/189 25.1 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 189/189 17.6 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 121.9        
                                                                 configs/s    
[422s] Generation 13 complete: error=17 ok=177 min=0.0082 mid=0.0101 max=0.1060 best=Config(block_sizes=[32, 32, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[422s] Generation 14 starting: 200 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 200/200 27.1 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 200/200 17.6 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.4        
                                                                 configs/s    
[454s] Generation 14 complete: error=17 ok=188 min=0.0091 mid=0.0104 max=0.1060 best=Config(block_sizes=[16, 64, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[454s] Generation 15 starting: 193 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 193/193 23.6 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 193/193 17.4 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.7        
                                                                 configs/s    
[486s] Generation 15 complete: error=15 ok=183 min=0.0085 mid=0.0104 max=0.1070 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[1], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[486s] Generation 16 starting: 194 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 194/194 24.9 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 194/194 17.7 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 118.7        
                                                                 configs/s    
[517s] Generation 16 complete: error=18 ok=181 min=0.0082 mid=0.0109 max=0.2689 best=Config(block_sizes=[16, 64, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[517s] Generation 17 starting: 197 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 197/197 26.2 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 17.7 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 116.7        
                                                                 configs/s    
[549s] Generation 17 complete: error=18 ok=184 min=0.0087 mid=0.0103 max=0.2698 best=Config(block_sizes=[16, 64, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[549s] Generation 18 starting: 198 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 198/198 23.8 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 198/198 17.7 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.0        
                                                                 configs/s    
[582s] Generation 18 complete: error=18 ok=185 min=0.0085 mid=0.0104 max=0.2701 best=Config(block_sizes=[16, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[582s] Generation 19 starting: 195 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 195/195 24.5 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 195/195 17.7 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.8        
                                                                 configs/s    
[614s] Generation 19 complete: error=18 ok=182 min=0.0079 mid=0.0104 max=0.1091 best=Config(block_sizes=[16, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[True, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[614s] Generation 20 starting: 201 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 201/201 25.2 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 201/201 17.6 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.0        
                                                                 configs/s    
[647s] Generation 20 complete: error=17 ok=189 min=0.0084 mid=0.0101 max=0.1089 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[647s] Autotuning complete in 647.1s after searching 4018 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 1:
(M, K, N)
---------------
(384, 512, 640)
 10%|█         | 2/20 [23:54<3:31:38, 705.48s/it]WARNING:tritonbench.utils.triton_op:Running input ID 2:
(M, K, N)
---------------
(512, 640, 768)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_84", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.011547000147402287, "best_triton_pos": 0}
AUTOTUNE mm(512x640, 640x768)
strides: [640, 1], [768, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_84 0.0115 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_94 0.0116 ms 99.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_77 0.0118 ms 98.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_76 0.0128 ms 90.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_83 0.0135 ms 85.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_78 0.0138 ms 83.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_85 0.0139 ms 83.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=False, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_74 0.0139 ms 83.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=32, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_91 0.0141 ms 82.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_79 0.0142 ms 81.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.3751 seconds and 0.8383 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1729.50ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 56.37ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (512, 640),
              'stride': (640, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (640, 768),
              'stride': (768, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 9.18ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 5.4 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 19.3         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 2295.4 configs/s
[25s] Initial random population of 100, 5 starting points: error=29 ok=71 min=0.0134 mid=0.1335 max=56.8062 best=Config(block_sizes=[16, 16, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[25s] Generation 1 starting: 200 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 19.9 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 17.5 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 194.4         
                                                                configs/s     
[55s] Generation 1 complete: error=8 ok=197 min=0.0111 mid=0.0179 max=0.5937 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[55s] Generation 2 starting: 181 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 181/181 19.4 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 181/181 17.3 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 181.7         
                                                                configs/s     
[84s] Generation 2 complete: error=7 ok=179 min=0.0102 mid=0.0149 max=0.6082 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[85s] Generation 3 starting: 182 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 182/182 18.0 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 182/182 17.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 122.7         
                                                                configs/s     
[117s] Generation 3 complete: error=14 ok=173 min=0.0097 mid=0.0122 max=0.4629 best=Config(block_sizes=[16, 32, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[117s] Generation 4 starting: 197 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 21.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 197/197 18.0 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 120.5         
                                                                configs/s     
[150s] Generation 4 complete: error=15 ok=187 min=0.0097 mid=0.0125 max=0.2912 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[150s] Generation 5 starting: 188 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 188/188 21.3 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 188/188 17.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.5         
                                                                configs/s     
[182s] Generation 5 complete: error=13 ok=180 min=0.0101 mid=0.0121 max=0.2901 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[182s] Generation 6 starting: 197 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 22.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 197/197 17.8 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 120.4         
                                                                configs/s     
[214s] Generation 6 complete: error=13 ok=189 min=0.0095 mid=0.0115 max=0.2910 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[214s] Generation 7 starting: 197 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 22.0 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 197/197 17.9 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.4         
                                                                configs/s     
[246s] Generation 7 complete: error=13 ok=189 min=0.0098 mid=0.0116 max=0.2899 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[246s] Generation 8 starting: 200 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 21.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 17.7 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.5         
                                                                configs/s     
[279s] Generation 8 complete: error=13 ok=192 min=0.0095 mid=0.0115 max=0.5758 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[279s] Generation 9 starting: 200 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 21.8 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 17.6 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 124.0         
                                                                configs/s     
[313s] Generation 9 complete: error=11 ok=194 min=0.0098 mid=0.0117 max=0.5756 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[313s] Generation 10 starting: 200 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 200/200 19.8 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 200/200 16.6 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 124.4        
                                                                 configs/s    
[346s] Generation 10 complete: error=11 ok=194 min=0.0093 mid=0.0116 max=0.5743 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[346s] Generation 11 starting: 197 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 197/197 21.2 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 17.6 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.4        
                                                                 configs/s    
[379s] Generation 11 complete: error=11 ok=191 min=0.0099 mid=0.0117 max=0.2706 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[379s] Generation 12 starting: 199 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 199/199 20.6 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 199/199 17.7 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 124.2        
                                                                 configs/s    
[412s] Generation 12 complete: error=12 ok=192 min=0.0102 mid=0.0118 max=0.5741 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[412s] Generation 13 starting: 196 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 196/196 21.4 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 196/196 17.6 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 128.3        
                                                                 configs/s    
[445s] Generation 13 complete: error=12 ok=189 min=0.0099 mid=0.0117 max=0.5732 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[445s] Generation 14 starting: 195 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 195/195 20.9 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 195/195 17.8 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 131.6        
                                                                 configs/s    
[477s] Generation 14 complete: error=14 ok=186 min=0.0093 mid=0.0116 max=0.5739 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[477s] Generation 15 starting: 195 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 195/195 19.7 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 195/195 17.8 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 129.3        
                                                                 configs/s    
[510s] Generation 15 complete: error=14 ok=186 min=0.0095 mid=0.0116 max=0.5738 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[510s] Generation 16 starting: 192 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 192/192 20.6 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 192/192 17.9 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 130.6        
                                                                 configs/s    
[541s] Generation 16 complete: error=14 ok=183 min=0.0098 mid=0.0117 max=0.5734 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[541s] Generation 17 starting: 197 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 197/197 20.6 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 17.9 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 127.2        
                                                                 configs/s    
[574s] Generation 17 complete: error=14 ok=188 min=0.0097 mid=0.0116 max=0.5786 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[574s] Generation 18 starting: 191 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 191/191 20.4 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 191/191 17.7 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 132.1        
                                                                 configs/s    
[606s] Generation 18 complete: error=12 ok=184 min=0.0097 mid=0.0117 max=0.5793 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[606s] Generation 19 starting: 198 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 198/198 19.1 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 198/198 17.6 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.7        
                                                                 configs/s    
[640s] Generation 19 complete: error=13 ok=190 min=0.0091 mid=0.0115 max=0.5786 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[640s] Generation 20 starting: 196 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 196/196 19.9 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 196/196 16.8 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 129.3        
                                                                 configs/s    
[673s] Generation 20 complete: error=13 ok=188 min=0.0091 mid=0.0115 max=0.5785 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[673s] Autotuning complete in 673.3s after searching 3998 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 2:
(M, K, N)
---------------
(512, 640, 768)
 15%|█▌        | 3/20 [35:11<3:16:14, 692.60s/it]WARNING:tritonbench.utils.triton_op:Running input ID 3:
(M, K, N)
---------------
(640, 768, 896)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.05ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_121", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.011145000346004963, "best_triton_pos": 0}
AUTOTUNE mm(640x768, 768x896)
strides: [768, 1], [896, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_121 0.0111 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_116 0.0115 ms 96.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_114 0.0117 ms 94.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_117 0.0120 ms 93.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_127 0.0122 ms 91.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_119 0.0128 ms 87.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_126 0.0131 ms 85.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_125 0.0132 ms 84.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_130 0.0132 ms 84.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_120 0.0139 ms 80.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.3706 seconds and 0.8167 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1766.35ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 56.51ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (640, 768),
              'stride': (768, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (768, 896),
              'stride': (896, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 8.89ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 4.9 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 17.1         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 2691.4 configs/s
[27s] Initial random population of 100, 5 starting points: error=27 ok=73 min=0.0145 mid=0.2616 max=46.5824 best=Config(block_sizes=[16, 32, 64], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=1, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[27s] Generation 1 starting: 216 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 216/216 18.2 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 216/216 16.2 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 232.5         
                                                                configs/s     
[61s] Generation 1 complete: error=4 ok=217 min=0.0120 mid=0.0183 max=0.3318 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[61s] Generation 2 starting: 190 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 190/190 17.9 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 190/190 17.0 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 116.5         
                                                                configs/s     
[96s] Generation 2 complete: error=4 ok=191 min=0.0111 mid=0.0144 max=0.1471 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[96s] Generation 3 starting: 194 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 194/194 15.8 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 194/194 17.3 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 111.9         
                                                                configs/s     
[132s] Generation 3 complete: error=9 ok=190 min=0.0106 mid=0.0134 max=0.0896 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[132s] Generation 4 starting: 191 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 191/191 13.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 191/191 18.3 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 123.6         
                                                                configs/s     
[169s] Generation 4 complete: error=17 ok=179 min=0.0109 mid=0.0124 max=0.2459 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[169s] Generation 5 starting: 200 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 200/200 18.9 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 200/200 18.4 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.5         
                                                                configs/s     
[204s] Generation 5 complete: error=18 ok=187 min=0.0109 mid=0.0125 max=0.2462 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[204s] Generation 6 starting: 208 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 208/208 18.9 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 208/208 18.5 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 110.7         
                                                                configs/s     
[240s] Generation 6 complete: error=20 ok=193 min=0.0107 mid=0.0125 max=0.2461 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[240s] Generation 7 starting: 196 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 196/196 13.9 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 196/196 18.6 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.9         
                                                                configs/s     
[278s] Generation 7 complete: error=22 ok=179 min=0.0107 mid=0.0121 max=0.2470 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[278s] Generation 8 starting: 203 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 203/203 13.7 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 203/203 18.8 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 115.0         
                                                                configs/s     
[316s] Generation 8 complete: error=24 ok=184 min=0.0108 mid=0.0121 max=0.2457 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[317s] Generation 9 starting: 204 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 204/204 13.9 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 204/204 18.8 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 110.2         
                                                                configs/s     
[356s] Generation 9 complete: error=25 ok=184 min=0.0108 mid=0.0122 max=0.2458 best=Config(block_sizes=[16, 32, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[16], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[356s] Generation 10 starting: 204 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 204/204 18.5 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 204/204 19.0 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.5        
                                                                 configs/s    
[392s] Generation 10 complete: error=25 ok=184 min=0.0106 mid=0.0122 max=0.2468 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[392s] Generation 11 starting: 206 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 206/206 18.4 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 206/206 19.0 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.2        
                                                                 configs/s    
[428s] Generation 11 complete: error=25 ok=186 min=0.0109 mid=0.0122 max=0.2459 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[428s] Generation 12 starting: 207 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 207/207 17.9 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 207/207 19.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.2        
                                                                 configs/s    
[463s] Generation 12 complete: error=25 ok=187 min=0.0109 mid=0.0122 max=0.2444 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[463s] Generation 13 starting: 206 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 206/206 13.6 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 206/206 18.8 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.7        
                                                                 configs/s    
[503s] Generation 13 complete: error=25 ok=186 min=0.0107 mid=0.0123 max=0.2452 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[503s] Generation 14 starting: 208 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 208/208 13.3 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 208/208 19.0 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 111.3        
                                                                 configs/s    
[543s] Generation 14 complete: error=25 ok=188 min=0.0109 mid=0.0123 max=0.2461 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[543s] Generation 15 starting: 207 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 207/207 17.5 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 207/207 19.0 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 111.5        
                                                                 configs/s    
[579s] Generation 15 complete: error=25 ok=187 min=0.0108 mid=0.0123 max=0.2461 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[579s] Generation 16 starting: 202 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 202/202 17.3 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 202/202 18.9 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 116.6        
                                                                 configs/s    
[615s] Generation 16 complete: error=24 ok=183 min=0.0107 mid=0.0122 max=0.2454 best=Config(block_sizes=[16, 128, 256], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[615s] Generation 17 starting: 198 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 198/198 17.2 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 198/198 18.9 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.8        
                                                                 configs/s    
[649s] Generation 17 complete: error=24 ok=179 min=0.0098 mid=0.0122 max=0.2471 best=Config(block_sizes=[32, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[False, None], range_num_stages=[4, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[649s] Generation 18 starting: 197 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 197/197 13.9 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 18.8 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 124.4        
                                                                 configs/s    
[686s] Generation 18 complete: error=23 ok=179 min=0.0096 mid=0.0121 max=0.2459 best=Config(block_sizes=[32, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[False, None], range_num_stages=[4, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[686s] Generation 19 starting: 201 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 201/201 16.1 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 201/201 19.0 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.0        
                                                                 configs/s    
[721s] Generation 19 complete: error=25 ok=181 min=0.0097 mid=0.0120 max=0.2453 best=Config(block_sizes=[32, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[4, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[721s] Generation 20 starting: 207 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 207/207 16.1 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 207/207 18.9 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 120.1        
                                                                 configs/s    
[758s] Generation 20 complete: error=25 ok=187 min=0.0095 mid=0.0119 max=0.2456 best=Config(block_sizes=[32, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, None], range_multi_buffers=[False, True], range_num_stages=[4, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[758s] Autotuning complete in 758.9s after searching 4145 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[32, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='persistent_interleaved', range_flattens=[None, None], range_multi_buffers=[False, True], range_num_stages=[4, 0], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 3:
(M, K, N)
---------------
(640, 768, 896)
 20%|██        | 4/20 [47:54<3:12:05, 720.35s/it]WARNING:tritonbench.utils.triton_op:Running input ID 4:
(M, K, N)
----------------
(768, 896, 1024)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_148", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4", "best_time": 0.012508000247180462, "best_triton_pos": 0}
AUTOTUNE mm(768x896, 896x1024)
strides: [896, 1], [1024, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_148 0.0125 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_161 0.0125 ms 99.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_150 0.0136 ms 91.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_156 0.0140 ms 89.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_155 0.0142 ms 87.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_157 0.0153 ms 81.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=False, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_149 0.0160 ms 78.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_153 0.0162 ms 77.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_151 0.0162 ms 77.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_152 0.0166 ms 75.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.3786 seconds and 0.8709 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1731.68ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 56.50ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (768, 896),
              'stride': (896, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (896, 1024),
              'stride': (1024, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 8.80ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.1 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 14.4         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 3255.2 configs/s
[51s] Initial random population of 100, 5 starting points: error=26 ok=74 min=0.0183 mid=0.3935 max=72.5107 best=Config(block_sizes=[16, 32, 64], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=1, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[51s] Generation 1 starting: 217 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 217/217 9.5 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 217/217 17.9 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 168.4         
                                                                configs/s     
[96s] Generation 1 complete: error=14 ok=208 min=0.0148 mid=0.0233 max=0.3666 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[96s] Generation 2 starting: 197 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 197/197 9.1 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 197/197 18.0 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 121.7         
                                                                configs/s     
[142s] Generation 2 complete: error=14 ok=188 min=0.0147 mid=0.0206 max=0.3660 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[142s] Generation 3 starting: 163 neighbors, 4 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 163/163 8.3 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 163/163 17.8 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 138.7         
                                                                configs/s     
[181s] Generation 3 complete: error=12 ok=156 min=0.0149 mid=0.0193 max=0.3628 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[181s] Generation 4 starting: 132 neighbors, 3 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 132/132 6.8 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 132/132 18.1 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 161.3         
                                                                configs/s     
[219s] Generation 4 complete: error=12 ok=124 min=0.0146 mid=0.0192 max=0.2565 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[219s] Generation 5 starting: 128 neighbors, 3 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 128/128 16.1 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 128/128 18.6 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 169.5         
                                                                configs/s     
[243s] Generation 5 complete: error=12 ok=119 min=0.0146 mid=0.0194 max=0.2551 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[243s] Generation 6 starting: 45 neighbors, 1 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.1 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 45/45 22.0 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 639.0         
                                                                configs/s     
[250s] Generation 6 complete: error=9 ok=38 min=0.0151 mid=0.0198 max=0.2553 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[250s] Generation 7 starting: 46 neighbors, 1 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 46/46 16.2 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 46/46 21.9 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 611.9         
                                                                configs/s     
[258s] Generation 7 complete: error=9 ok=39 min=0.0151 mid=0.0198 max=0.2551 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[258s] Generation 8 starting: 45 neighbors, 1 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 45/45 22.0 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 631.9         
                                                                configs/s     
[266s] Generation 8 complete: error=9 ok=38 min=0.0151 mid=0.0198 max=0.2562 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[266s] Generation 9 starting: 45 neighbors, 1 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.7 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 45/45 22.0 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 626.4         
                                                                configs/s     
[274s] Generation 9 complete: error=9 ok=38 min=0.0151 mid=0.0198 max=0.2555 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[274s] Generation 10 starting: 46 neighbors, 1 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 46/46 16.6 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 46/46 21.9 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 605.2        
                                                                 configs/s    
[282s] Generation 10 complete: error=9 ok=39 min=0.0151 mid=0.0198 max=0.2552 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[282s] Generation 11 starting: 45 neighbors, 1 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 17.2 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 45/45 22.0 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 641.9        
                                                                 configs/s    
[290s] Generation 11 complete: error=9 ok=38 min=0.0151 mid=0.0198 max=0.2558 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[290s] Generation 12 starting: 45 neighbors, 1 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.7 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 45/45 22.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 636.1        
                                                                 configs/s    
[297s] Generation 12 complete: error=9 ok=38 min=0.0151 mid=0.0198 max=0.2555 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[297s] Generation 13 starting: 45 neighbors, 1 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.2 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 45/45 22.7 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 662.7        
                                                                 configs/s    
[305s] Generation 13 complete: error=10 ok=37 min=0.0151 mid=0.0198 max=0.2548 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[305s] Generation 14 starting: 45 neighbors, 1 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 16.7 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 45/45 22.6 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 655.0        
                                                                 configs/s    
[312s] Generation 14 complete: error=10 ok=37 min=0.0151 mid=0.0198 max=0.2554 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[312s] Generation 15 starting: 45 neighbors, 1 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 45/45 3.2 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 45/45 21.4 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 634.7        
                                                                 configs/s    
[332s] Generation 15 complete: error=10 ok=37 min=0.0151 mid=0.0197 max=0.2549 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[332s] Autotuning complete in 332.5s after searching 1389 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[4, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 4:
(M, K, N)
----------------
(768, 896, 1024)
 25%|██▌       | 5/20 [53:30<2:25:28, 581.90s/it]WARNING:tritonbench.utils.triton_op:Running input ID 5:
(M, K, N)
-----------------
(896, 1024, 1152)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_193", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.012628999538719654, "best_triton_pos": 0}
AUTOTUNE mm(896x1024, 1024x1152)
strides: [1024, 1], [1152, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_193 0.0126 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_184 0.0139 ms 91.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_192 0.0153 ms 82.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_186 0.0162 ms 77.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_196 0.0165 ms 76.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_191 0.0165 ms 76.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_189 0.0172 ms 73.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_187 0.0181 ms 69.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_197 0.0183 ms 69.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_194 0.0184 ms 68.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.3955 seconds and 0.7966 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1811.91ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 70.90ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (896, 1024),
              'stride': (1024, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1024, 1152),
              'stride': (1152, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 7.64ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 2.9 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 13.0         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 4023.9 configs/s
[40s] Initial random population of 100, 5 starting points: error=26 ok=74 min=0.0231 mid=0.5412 max=105.3520 best=Config(block_sizes=[16, 128, 256], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[True, None], range_multi_buffers=[None, None], range_num_stages=[1, 1], range_unroll_factors=[4, 4], range_warp_specializes=[], waves_per_eu=1)
[41s] Generation 1 starting: 224 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 224/224 9.8 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 224/224 18.5 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 173.2         
                                                                configs/s     
[87s] Generation 1 complete: error=21 ok=208 min=0.0181 mid=0.0292 max=1.4104 best=Config(block_sizes=[16, 128, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[87s] Generation 2 starting: 201 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 201/201 8.7 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 201/201 18.4 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 106.7         
                                                                configs/s     
[137s] Generation 2 complete: error=20 ok=186 min=0.0168 mid=0.0212 max=0.3861 best=Config(block_sizes=[64, 64, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[64], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[3, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[137s] Generation 3 starting: 214 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 214/214 8.9 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 214/214 18.6 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 110.2         
                                                                configs/s     
[187s] Generation 3 complete: error=22 ok=197 min=0.0159 mid=0.0201 max=0.3717 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[187s] Generation 4 starting: 170 neighbors, 4 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 170/170 10.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 170/170 18.6 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 141.2         
                                                                configs/s     
[223s] Generation 4 complete: error=17 ok=157 min=0.0151 mid=0.0206 max=0.3681 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[223s] Generation 5 starting: 125 neighbors, 3 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 125/125 14.5 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 125/125 19.6 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 204.1         
                                                                configs/s     
[246s] Generation 5 complete: error=15 ok=114 min=0.0158 mid=0.0208 max=0.3677 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[246s] Generation 6 starting: 124 neighbors, 3 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 124/124 14.5 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 124/124 19.7 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 212.9         
                                                                configs/s     
[268s] Generation 6 complete: error=15 ok=113 min=0.0158 mid=0.0207 max=0.3674 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[268s] Generation 7 starting: 123 neighbors, 3 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 123/123 14.6 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 123/123 19.5 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 216.2         
                                                                configs/s     
[291s] Generation 7 complete: error=14 ok=113 min=0.0158 mid=0.0208 max=0.3693 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[291s] Generation 8 starting: 121 neighbors, 3 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 121/121 11.7 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 121/121 19.4 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 221.5         
                                                                configs/s     
[314s] Generation 8 complete: error=14 ok=111 min=0.0158 mid=0.0207 max=0.3688 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[314s] Generation 9 starting: 85 neighbors, 2 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 85/85 14.8 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 85/85 20.3 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 325.6         
                                                                configs/s     
[329s] Generation 9 complete: error=12 ok=76 min=0.0158 mid=0.0207 max=0.3688 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[329s] Generation 10 starting: 85 neighbors, 2 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 85/85 13.5 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 85/85 20.0 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 333.1        
                                                                 configs/s    
[345s] Generation 10 complete: error=12 ok=76 min=0.0158 mid=0.0207 max=0.3667 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[345s] Generation 11 starting: 85 neighbors, 2 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 85/85 13.4 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 85/85 20.0 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 334.9        
                                                                 configs/s    
[361s] Generation 11 complete: error=12 ok=76 min=0.0158 mid=0.0208 max=0.3699 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[361s] Generation 12 starting: 83 neighbors, 2 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 83/83 14.8 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 83/83 20.1 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 333.9        
                                                                 configs/s    
[376s] Generation 12 complete: error=11 ok=75 min=0.0158 mid=0.0208 max=0.3674 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[376s] Generation 13 starting: 41 neighbors, 1 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 41/41 16.0 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 41/41 18.5 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 681.3        
                                                                 configs/s    
[383s] Generation 13 complete: error=2 ok=41 min=0.0156 mid=0.0180 max=0.2024 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[383s] Generation 14 starting: 40 neighbors, 1 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 40/40 13.5 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 40/40 18.1 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 722.4        
                                                                 configs/s    
[391s] Generation 14 complete: error=2 ok=40 min=0.0156 mid=0.0197 max=0.2028 best=Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1)
[391s] Autotuning complete in 391.5s after searching 1821 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=5, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[False, True], range_num_stages=[3, 2], range_unroll_factors=[3, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 5:
(M, K, N)
-----------------
(896, 1024, 1152)
 30%|███       | 6/20 [1:00:06<2:00:59, 518.50s/it]WARNING:tritonbench.utils.triton_op:Running input ID 6:
(M, K, N)
------------------
(1024, 1152, 1280)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_238", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.016116000711917877, "best_triton_pos": 0}
AUTOTUNE mm(1024x1152, 1152x1280)
strides: [1152, 1], [1280, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_238 0.0161 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_227 0.0169 ms 95.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_233 0.0186 ms 86.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_244 0.0197 ms 81.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_220 0.0204 ms 79.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_232 0.0209 ms 77.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_236 0.0215 ms 75.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_237 0.0215 ms 74.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_235 0.0219 ms 73.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_230 0.0228 ms 70.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.4054 seconds and 0.8488 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1834.71ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 71.09ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1024, 1152),
              'stride': (1152, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1152, 1280),
              'stride': (1280, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 7.65ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[68s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
[72s] Timeout after 60s compiling Config(block_sizes=[1, 256, 512], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, False], range_num_stages=[4, 0], range_unroll_factors=[3, 3], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.2 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 5.0 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 5423.2 configs/s
[114s] Initial random population of 100, 5 starting points: error=31 timeout=2 ok=67 min=0.0343 mid=0.6776 max=2731.6282 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[114s] Generation 1 starting: 216 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 216/216 12.7 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 216/216 18.0 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 762.9         
                                                                configs/s     
[148s] Generation 1 complete: error=11 ok=210 min=0.0227 mid=0.0502 max=0.5147 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[148s] Generation 2 starting: 190 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 190/190 11.0 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 190/190 18.3 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 134.1         
                                                                configs/s     
[188s] Generation 2 complete: error=16 ok=179 min=0.0219 mid=0.0311 max=0.1865 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[188s] Generation 3 starting: 184 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 184/184 12.6 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 184/184 17.9 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 152.0         
                                                                configs/s     
[224s] Generation 3 complete: error=12 ok=177 min=0.0214 mid=0.0295 max=0.1421 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[224s] Generation 4 starting: 192 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 192/192 12.0 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 192/192 18.2 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 160.9         
                                                                configs/s     
[261s] Generation 4 complete: error=14 ok=183 min=0.0203 mid=0.0299 max=0.1418 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[261s] Generation 5 starting: 158 neighbors, 4 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 158/158 12.1 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 158/158 18.5 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 201.9         
                                                                configs/s     
[292s] Generation 5 complete: error=14 ok=148 min=0.0199 mid=0.0297 max=0.1422 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[292s] Generation 6 starting: 121 neighbors, 3 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 121/121 12.3 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 121/121 17.8 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 283.8         
                                                                configs/s     
[315s] Generation 6 complete: error=5 ok=120 min=0.0203 mid=0.0317 max=0.1421 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[315s] Generation 7 starting: 113 neighbors, 3 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 113/113 12.1 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 113/113 17.8 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 324.5         
                                                                configs/s     
[336s] Generation 7 complete: error=5 ok=112 min=0.0204 mid=0.0326 max=0.1420 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[336s] Generation 8 starting: 77 neighbors, 2 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 77/77 14.3 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 77/77 17.1 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 274.8         
                                                                configs/s     
[353s] Generation 8 complete: ok=80 min=0.0203 mid=0.0258 max=0.1423 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[353s] Generation 9 starting: 35 neighbors, 1 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 35/35 15.0 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 35/35 17.6 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 744.1         
                                                                configs/s     
[360s] Generation 9 complete: ok=37 min=0.0203 mid=0.0276 max=0.1430 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[360s] Generation 10 starting: 38 neighbors, 1 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 13.7 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 17.0 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 649.8        
                                                                 configs/s    
[368s] Generation 10 complete: ok=40 min=0.0206 mid=0.0264 max=0.1424 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[368s] Autotuning complete in 368.3s after searching 1422 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 6:
(M, K, N)
------------------
(1024, 1152, 1280)
 35%|███▌      | 7/20 [1:06:18<1:41:59, 470.70s/it]WARNING:tritonbench.utils.triton_op:Running input ID 7:
(M, K, N)
------------------
(1152, 1280, 1408)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_274", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.017920000478625298, "best_triton_pos": 0}
AUTOTUNE mm(1152x1280, 1280x1408)
strides: [1280, 1], [1408, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_274 0.0179 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_269 0.0194 ms 92.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_263 0.0216 ms 83.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_268 0.0241 ms 74.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_256 0.0247 ms 72.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_280 0.0267 ms 67.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_271 0.0268 ms 66.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_265 0.0275 ms 65.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_264 0.0277 ms 64.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_259 0.0282 ms 63.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.4097 seconds and 0.8132 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1813.56ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 70.14ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1152, 1280),
              'stride': (1280, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1280, 1408),
              'stride': (1408, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 7.11ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[68s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 7.8 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 8016.8 configs/s
[81s] Initial random population of 100, 5 starting points: error=33 timeout=1 ok=66 min=0.0371 mid=0.9480 max=369.5717 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[81s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 223/223 11.1 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 17.9 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 763.3         
                                                                configs/s     
[119s] Generation 1 complete: error=11 ok=217 min=0.0256 mid=0.0621 max=0.3033 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[119s] Generation 2 starting: 189 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 189/189 8.6 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 189/189 18.2 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 177.1         
                                                                configs/s     
[162s] Generation 2 complete: error=13 ok=181 min=0.0231 mid=0.0403 max=0.1855 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[162s] Generation 3 starting: 181 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 181/181 12.3 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 181/181 18.3 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 196.9         
                                                                configs/s     
[196s] Generation 3 complete: error=14 ok=172 min=0.0218 mid=0.0366 max=0.0951 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[196s] Generation 4 starting: 185 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 185/185 12.3 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 185/185 18.1 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 153.0         
                                                                configs/s     
[231s] Generation 4 complete: error=12 ok=178 min=0.0209 mid=0.0318 max=0.0975 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[231s] Generation 5 starting: 195 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 195/195 12.2 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 195/195 18.2 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 166.1         
                                                                configs/s     
[269s] Generation 5 complete: error=14 ok=186 min=0.0203 mid=0.0315 max=0.0977 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[269s] Generation 6 starting: 158 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 158/158 12.0 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 158/158 18.4 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 210.5         
                                                                configs/s     
[299s] Generation 6 complete: error=14 ok=148 min=0.0201 mid=0.0309 max=0.0965 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[299s] Generation 7 starting: 115 neighbors, 3 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 115/115 13.1 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 115/115 18.6 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 224.9         
                                                                configs/s     
[321s] Generation 7 complete: error=11 ok=107 min=0.0200 mid=0.0268 max=0.1086 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[321s] Generation 8 starting: 109 neighbors, 3 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 109/109 13.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 109/109 18.5 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 224.1         
                                                                configs/s     
[343s] Generation 8 complete: error=10 ok=102 min=0.0200 mid=0.0258 max=0.0966 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[343s] Generation 9 starting: 32 neighbors, 1 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 32/32 12.3 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 32/32 17.6 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 782.1         
                                                                configs/s     
[350s] Generation 9 complete: error=1 ok=33 min=0.0199 mid=0.0261 max=0.0573 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[350s] Generation 10 starting: 30 neighbors, 1 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 30/30 10.7 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 30/30 17.4 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 678.6        
                                                                 configs/s    
[359s] Generation 10 complete: error=1 ok=31 min=0.0202 mid=0.0245 max=0.0504 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[359s] Generation 11 starting: 38 neighbors, 1 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 11.4 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 17.4 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 591.5        
                                                                 configs/s    
[368s] Generation 11 complete: error=1 ok=39 min=0.0202 mid=0.0253 max=0.0507 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[368s] Generation 12 starting: 37 neighbors, 1 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 37/37 13.8 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 37/37 18.1 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 616.4        
                                                                 configs/s    
[375s] Generation 12 complete: error=1 ok=38 min=0.0201 mid=0.0254 max=0.0506 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[375s] Generation 13 starting: 38 neighbors, 1 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 13.7 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 17.6 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 567.1        
                                                                 configs/s    
[383s] Generation 13 complete: ok=40 min=0.0202 mid=0.0253 max=0.0506 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[383s] Generation 14 starting: 39 neighbors, 1 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 13.2 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 17.4 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 545.6        
                                                                 configs/s    
[391s] Generation 14 complete: ok=41 min=0.0202 mid=0.0251 max=0.0509 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[391s] Generation 15 starting: 37 neighbors, 1 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 37/37 13.9 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 37/37 17.5 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 588.5        
                                                                 configs/s    
[399s] Generation 15 complete: ok=39 min=0.0202 mid=0.0253 max=0.0509 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[399s] Generation 16 starting: 37 neighbors, 1 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 37/37 13.3 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 37/37 17.4 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 591.5        
                                                                 configs/s    
[407s] Generation 16 complete: ok=39 min=0.0202 mid=0.0253 max=0.0510 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[407s] Generation 17 starting: 36 neighbors, 1 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 36/36 11.7 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 36/36 16.9 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 615.6        
                                                                 configs/s    
[416s] Generation 17 complete: ok=38 min=0.0201 mid=0.0254 max=0.0508 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[416s] Generation 18 starting: 35 neighbors, 1 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 35/35 13.3 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 35/35 17.5 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 643.9        
                                                                 configs/s    
[423s] Generation 18 complete: ok=37 min=0.0201 mid=0.0255 max=0.0508 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[423s] Generation 19 starting: 37 neighbors, 1 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 37/37 11.0 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 37/37 16.9 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 589.2        
                                                                 configs/s    
[432s] Generation 19 complete: ok=39 min=0.0202 mid=0.0251 max=0.0500 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[432s] Generation 20 starting: 38 neighbors, 1 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 10.7 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 16.9 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 566.1        
                                                                 configs/s    
[441s] Generation 20 complete: ok=40 min=0.0202 mid=0.0251 max=0.0504 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[441s] Autotuning complete in 441.6s after searching 1888 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 7:
(M, K, N)
------------------
(1152, 1280, 1408)
 40%|████      | 8/20 [1:13:44<1:32:32, 462.70s/it]WARNING:tritonbench.utils.triton_op:Running input ID 8:
(M, K, N)
------------------
(1280, 1408, 1536)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_299", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4", "best_time": 0.02405400015413761, "best_triton_pos": 0}
AUTOTUNE mm(1280x1408, 1408x1536)
strides: [1408, 1], [1536, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_299 0.0241 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_304 0.0246 ms 97.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_310 0.0248 ms 96.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_316 0.0249 ms 96.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_309 0.0277 ms 86.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_305 0.0288 ms 83.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_302 0.0293 ms 82.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_303 0.0294 ms 81.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_300 0.0299 ms 80.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_307 0.0300 ms 80.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=32, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.4205 seconds and 0.8704 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1824.63ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.75ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1280, 1408),
              'stride': (1408, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1408, 1536),
              'stride': (1536, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 8.91ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[69s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 6.2 configs/s
[85s] Initial random population of 100, 5 starting points: error=32 timeout=1 ok=67 min=0.0533 mid=1.2485 max=459.6099 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[85s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 223/223 11.0 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 18.0 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 1120.6       
                                                                 configs/s    
[123s] Generation 1 complete: error=11 ok=217 min=0.0322 mid=0.0854 max=0.3884 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[123s] Generation 2 starting: 198 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 198/198 9.6 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 18.6 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 150.2         
                                                                configs/s     
[164s] Generation 2 complete: error=18 ok=185 min=0.0276 mid=0.0466 max=0.6436 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[164s] Generation 3 starting: 196 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 196/196 11.4 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 196/196 19.6 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 164.5         
                                                                configs/s     
[202s] Generation 3 complete: error=28 ok=173 min=0.0259 mid=0.0405 max=0.5288 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[202s] Generation 4 starting: 194 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 194/194 9.0 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 194/194 17.2 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 117.6         
                                                                configs/s     
[247s] Generation 4 complete: error=25 ok=174 min=0.0252 mid=0.0379 max=0.7779 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[247s] Generation 5 starting: 214 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 214/214 9.3 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 214/214 19.4 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.4         
                                                                configs/s     
[295s] Generation 5 complete: error=28 ok=191 min=0.0249 mid=0.0338 max=0.7769 best=Config(block_sizes=[64, 128, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[295s] Generation 6 starting: 198 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 198/198 11.2 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 19.7 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.9         
                                                                configs/s     
[336s] Generation 6 complete: error=28 ok=175 min=0.0243 mid=0.0324 max=0.7750 best=Config(block_sizes=[64, 128, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[336s] Generation 7 starting: 213 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 213/213 11.3 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 213/213 19.8 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 122.5         
                                                                configs/s     
[378s] Generation 7 complete: error=31 ok=187 min=0.0239 mid=0.0328 max=0.7711 best=Config(block_sizes=[64, 128, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[378s] Generation 8 starting: 170 neighbors, 4 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 170/170 11.9 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 170/170 19.5 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.3         
                                                                configs/s     
[415s] Generation 8 complete: error=21 ok=153 min=0.0242 mid=0.0314 max=0.1440 best=Config(block_sizes=[64, 128, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[415s] Generation 9 starting: 171 neighbors, 4 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 171/171 9.4 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 171/171 19.3 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 122.1         
                                                                configs/s     
[454s] Generation 9 complete: error=21 ok=154 min=0.0241 mid=0.0313 max=0.1437 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[454s] Generation 10 starting: 169 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 169/169 11.6 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 169/169 19.5 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.4        
                                                                 configs/s    
[489s] Generation 10 complete: error=21 ok=152 min=0.0239 mid=0.0313 max=0.1080 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[489s] Generation 11 starting: 169 neighbors, 4 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 169/169 9.4 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 169/169 19.3 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.8        
                                                                 configs/s    
[528s] Generation 11 complete: error=21 ok=152 min=0.0241 mid=0.0313 max=0.1090 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[528s] Generation 12 starting: 84 neighbors, 2 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 84/84 12.2 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 84/84 17.9 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 244.9        
                                                                 configs/s    
[547s] Generation 12 complete: error=4 ok=83 min=0.0241 mid=0.0319 max=0.0831 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[547s] Generation 13 starting: 81 neighbors, 2 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 81/81 11.9 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 81/81 18.0 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 258.6        
                                                                 configs/s    
[564s] Generation 13 complete: error=4 ok=80 min=0.0241 mid=0.0326 max=0.0831 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[564s] Generation 14 starting: 83 neighbors, 2 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 83/83 7.7 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 83/83 17.9 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 249.5        
                                                                 configs/s    
[585s] Generation 14 complete: error=4 ok=82 min=0.0242 mid=0.0324 max=0.0831 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[585s] Generation 15 starting: 39 neighbors, 1 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 12.4 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 17.8 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 554.8        
                                                                 configs/s    
[594s] Generation 15 complete: ok=41 min=0.0239 mid=0.0334 max=0.0831 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[594s] Generation 16 starting: 39 neighbors, 1 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 12.9 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 17.8 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 583.4        
                                                                 configs/s    
[602s] Generation 16 complete: ok=41 min=0.0239 mid=0.0345 max=0.0831 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[602s] Generation 17 starting: 39 neighbors, 1 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 10.8 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 17.3 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 578.2        
                                                                 configs/s    
[611s] Generation 17 complete: ok=41 min=0.0239 mid=0.0345 max=0.0833 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[611s] Autotuning complete in 611.8s after searching 2579 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 8:
(M, K, N)
------------------
(1280, 1408, 1536)
 45%|████▌     | 9/20 [1:23:59<1:33:35, 510.54s/it]WARNING:tritonbench.utils.triton_op:Running input ID 9:
(M, K, N)
------------------
(1408, 1536, 1664)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_341", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.02870500087738037, "best_triton_pos": 0}
AUTOTUNE mm(1408x1536, 1536x1664)
strides: [1536, 1], [1664, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_341 0.0287 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_346 0.0296 ms 96.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_352 0.0300 ms 95.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_340 0.0304 ms 94.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_336 0.0309 ms 92.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_335 0.0317 ms 90.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_337 0.0322 ms 89.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_351 0.0329 ms 87.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_345 0.0331 ms 86.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_339 0.0333 ms 86.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.4403 seconds and 0.8195 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1823.21ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.96ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1408, 1536),
              'stride': (1536, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1536, 1664),
              'stride': (1664, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 12.37ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[69s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 5.6 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 7839.4 configs/s
[87s] Initial random population of 100, 5 starting points: error=33 timeout=1 ok=66 min=0.0565 mid=1.6456 max=539.0511 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[87s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 223/223 4.6 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 16.5 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 1783.6       
                                                                 configs/s    
[151s] Generation 1 complete: error=11 ok=217 min=0.0355 mid=0.0981 max=0.5488 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[151s] Generation 2 starting: 198 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 198/198 7.2 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 18.6 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 166.6         
                                                                configs/s     
[199s] Generation 2 complete: error=14 ok=189 min=0.0295 mid=0.0552 max=0.4455 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[199s] Generation 3 starting: 177 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 177/177 8.8 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 177/177 19.6 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 162.9         
                                                                configs/s     
[238s] Generation 3 complete: error=23 ok=159 min=0.0290 mid=0.0441 max=0.1258 best=Config(block_sizes=[128, 64, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[238s] Generation 4 starting: 198 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 198/198 10.0 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 19.4 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.1         
                                                                configs/s     
[280s] Generation 4 complete: error=22 ok=181 min=0.0282 mid=0.0426 max=0.1680 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[280s] Generation 5 starting: 203 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 203/203 10.1 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 203/203 19.5 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 144.1         
                                                                configs/s     
[323s] Generation 5 complete: error=24 ok=184 min=0.0269 mid=0.0405 max=0.1626 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[323s] Generation 6 starting: 158 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 158/158 10.5 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 158/158 19.1 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 147.5         
                                                                configs/s     
[356s] Generation 6 complete: error=14 ok=148 min=0.0268 mid=0.0380 max=0.1618 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[356s] Generation 7 starting: 149 neighbors, 4 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 149/149 10.0 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 149/149 19.5 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 148.0         
                                                                configs/s     
[389s] Generation 7 complete: error=16 ok=137 min=0.0263 mid=0.0347 max=0.1638 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[389s] Generation 8 starting: 160 neighbors, 4 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 160/160 10.3 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 160/160 18.9 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 139.3         
                                                                configs/s     
[425s] Generation 8 complete: error=14 ok=150 min=0.0263 mid=0.0344 max=0.1615 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[425s] Generation 9 starting: 106 neighbors, 3 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 106/106 9.9 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 106/106 18.9 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 183.8         
                                                                configs/s     
[450s] Generation 9 complete: error=9 ok=101 min=0.0263 mid=0.0329 max=0.1571 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[450s] Generation 10 starting: 120 neighbors, 3 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 120/120 10.9 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 120/120 18.3 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 176.5        
                                                                 configs/s    
[476s] Generation 10 complete: error=5 ok=119 min=0.0263 mid=0.0325 max=0.1568 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[476s] Generation 11 starting: 111 neighbors, 3 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 111/111 10.0 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 111/111 19.0 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 188.0        
                                                                 configs/s    
[501s] Generation 11 complete: error=10 ok=105 min=0.0263 mid=0.0320 max=0.1735 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[501s] Generation 12 starting: 118 neighbors, 3 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 9.9 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 118/118 19.3 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 185.5        
                                                                 configs/s    
[529s] Generation 12 complete: error=12 ok=110 min=0.0264 mid=0.0326 max=0.1764 best=Config(block_sizes=[128, 64, 128], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[529s] Generation 13 starting: 117 neighbors, 3 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 117/117 9.8 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 19.3 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 188.0        
                                                                 configs/s    
[556s] Generation 13 complete: error=12 ok=109 min=0.0264 mid=0.0326 max=0.1763 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[556s] Generation 14 starting: 79 neighbors, 2 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 79/79 10.8 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 79/79 20.9 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 294.9        
                                                                 configs/s    
[572s] Generation 14 complete: error=11 ok=70 min=0.0268 mid=0.0324 max=0.1770 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[572s] Generation 15 starting: 39 neighbors, 1 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 11.5 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 19.5 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 674.4        
                                                                 configs/s    
[580s] Generation 15 complete: error=3 ok=38 min=0.0269 mid=0.0336 max=0.1564 best=Config(block_sizes=[64, 128, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[580s] Autotuning complete in 580.8s after searching 2255 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 128, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 9:
(M, K, N)
------------------
(1408, 1536, 1664)
 50%|█████     | 10/20 [1:33:44<1:28:54, 533.46s/it]WARNING:tritonbench.utils.triton_op:Running input ID 10:
(M, K, N)
------------------
(1536, 1664, 1792)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.08ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_388", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.030789999291300774, "best_triton_pos": 0}
AUTOTUNE mm(1536x1664, 1664x1792)
strides: [1664, 1], [1792, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_388 0.0308 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_381 0.0346 ms 89.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_374 0.0348 ms 88.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_387 0.0350 ms 88.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_386 0.0358 ms 86.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_390 0.0377 ms 81.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_371 0.0386 ms 79.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_376 0.0390 ms 78.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_380 0.0402 ms 76.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_394 0.0412 ms 74.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.4761 seconds and 0.9060 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2018.76ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.63ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1536, 1664),
              'stride': (1664, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1664, 1792),
              'stride': (1792, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 11.38ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[69s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 4.5 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 7956.9 configs/s
[91s] Initial random population of 100, 5 starting points: error=33 timeout=1 ok=66 min=0.0762 mid=2.0770 max=649.5683 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[91s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 223/223 9.7 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 18.1 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 355.6         
                                                                configs/s     
[134s] Generation 1 complete: error=11 ok=217 min=0.0574 mid=0.1440 max=0.5937 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[134s] Generation 2 starting: 191 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 191/191 6.9 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 191/191 18.4 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 180.4         
                                                                configs/s     
[183s] Generation 2 complete: error=12 ok=184 min=0.0452 mid=0.0726 max=0.5148 best=Config(block_sizes=[256, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[183s] Generation 3 starting: 172 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 172/172 6.5 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 172/172 19.0 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 102.2         
                                                                configs/s     
[232s] Generation 3 complete: error=18 ok=159 min=0.0437 mid=0.0596 max=0.2291 best=Config(block_sizes=[256, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[232s] Generation 4 starting: 158 neighbors, 4 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 158/158 6.7 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 158/158 18.6 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 130.8         
                                                                configs/s     
[274s] Generation 4 complete: error=13 ok=150 min=0.0437 mid=0.0581 max=0.2290 best=Config(block_sizes=[32, 128, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[274s] Generation 5 starting: 157 neighbors, 4 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 157/157 10.4 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 157/157 18.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 137.5         
                                                                configs/s     
[309s] Generation 5 complete: error=13 ok=148 min=0.0425 mid=0.0600 max=0.2291 best=Config(block_sizes=[32, 128, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[309s] Generation 6 starting: 128 neighbors, 3 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 128/128 6.3 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 128/128 19.6 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 213.2         
                                                                configs/s     
[343s] Generation 6 complete: error=16 ok=115 min=0.0378 mid=0.0585 max=0.1918 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[343s] Generation 7 starting: 69 neighbors, 2 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 69/69 7.7 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 69/69 17.7 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 225.2         
                                                                configs/s     
[363s] Generation 7 complete: error=2 ok=69 min=0.0382 mid=0.0509 max=0.1271 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[364s] Generation 8 starting: 69 neighbors, 2 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 69/69 7.7 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 69/69 18.4 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 208.8         
                                                                configs/s     
[383s] Generation 8 complete: error=3 ok=68 min=0.0374 mid=0.0445 max=0.0988 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[383s] Generation 9 starting: 76 neighbors, 2 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 76/76 8.1 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 76/76 18.3 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 193.8         
                                                                configs/s     
[404s] Generation 9 complete: error=4 ok=74 min=0.0374 mid=0.0452 max=0.1013 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[404s] Generation 10 starting: 75 neighbors, 2 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 75/75 10.8 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 75/75 18.6 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 200.3        
                                                                 configs/s    
[422s] Generation 10 complete: error=4 ok=73 min=0.0377 mid=0.0452 max=0.1004 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[422s] Generation 11 starting: 37 neighbors, 1 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 37/37 11.0 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 37/37 19.6 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 415.4        
                                                                 configs/s    
[431s] Generation 11 complete: error=3 ok=36 min=0.0378 mid=0.0474 max=0.0980 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[431s] Autotuning complete in 431.8s after searching 1454 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 10:
(M, K, N)
------------------
(1536, 1664, 1792)
 55%|█████▌    | 11/20 [1:41:00<1:15:32, 503.63s/it]WARNING:tritonbench.utils.triton_op:Running input ID 11:
(M, K, N)
------------------
(1664, 1792, 1920)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_424", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.0355600006878376, "best_triton_pos": 0}
AUTOTUNE mm(1664x1792, 1792x1920)
strides: [1792, 1], [1920, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_424 0.0356 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_423 0.0401 ms 88.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_417 0.0421 ms 84.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_407 0.0424 ms 83.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_422 0.0434 ms 82.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_412 0.0441 ms 80.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_410 0.0444 ms 80.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_416 0.0451 ms 78.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_426 0.0460 ms 77.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_409 0.0476 ms 74.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=256, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.5116 seconds and 0.8273 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 1973.52ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.69ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1664, 1792),
              'stride': (1792, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1792, 1920),
              'stride': (1920, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 8.76ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[69s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 3.9 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 7862.5 configs/s
[96s] Initial random population of 100, 5 starting points: error=32 timeout=1 ok=67 min=0.0961 mid=2.6198 max=791.0047 best=Config(block_sizes=[16, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[96s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 223/223 9.1 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 18.3 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 701.7         
                                                                configs/s     
[137s] Generation 1 complete: error=11 ok=217 min=0.0619 mid=0.1681 max=0.7855 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[137s] Generation 2 starting: 193 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 193/193 6.6 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 193/193 18.4 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 87.4         
                                                                 configs/s    
[194s] Generation 2 complete: error=15 ok=183 min=0.0539 mid=0.0817 max=0.5387 best=Config(block_sizes=[128, 128, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[True, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[194s] Generation 3 starting: 181 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 181/181 5.5 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 181/181 19.5 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.7         
                                                                configs/s     
[247s] Generation 3 complete: error=26 ok=160 min=0.0427 mid=0.0673 max=0.2563 best=Config(block_sizes=[128, 128, 128], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[247s] Generation 4 starting: 197 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 197/197 5.6 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 197/197 19.6 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 101.5         
                                                                configs/s     
[305s] Generation 4 complete: error=28 ok=174 min=0.0412 mid=0.0625 max=0.2589 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[305s] Generation 5 starting: 175 neighbors, 4 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 175/175 7.2 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 175/175 19.8 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.6         
                                                                configs/s     
[351s] Generation 5 complete: error=27 ok=152 min=0.0399 mid=0.0601 max=0.2632 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[351s] Generation 6 starting: 180 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 180/180 7.2 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 180/180 21.5 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 118.9         
                                                                configs/s     
[399s] Generation 6 complete: error=40 ok=144 min=0.0396 mid=0.0547 max=0.2629 best=Config(block_sizes=[128, 128, 128], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[399s] Generation 7 starting: 180 neighbors, 4 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 180/180 8.7 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 180/180 22.1 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 121.0         
                                                                configs/s     
[440s] Generation 7 complete: error=43 ok=141 min=0.0396 mid=0.0548 max=0.2589 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[4, 1], range_warp_specializes=[], waves_per_eu=1)
[440s] Generation 8 starting: 179 neighbors, 4 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 179/179 7.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 179/179 22.2 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 125.5         
                                                                configs/s     
[485s] Generation 8 complete: error=43 ok=140 min=0.0380 mid=0.0546 max=0.2651 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[485s] Generation 9 starting: 137 neighbors, 3 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 137/137 6.1 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 137/137 21.8 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 126.0         
                                                                configs/s     
[527s] Generation 9 complete: error=32 ok=108 min=0.0376 mid=0.0500 max=0.2628 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[527s] Generation 10 starting: 120 neighbors, 3 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 120/120 9.4 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 120/120 23.2 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 153.6        
                                                                 configs/s    
[554s] Generation 10 complete: error=32 ok=91 min=0.0378 mid=0.0536 max=0.2630 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[555s] Generation 11 starting: 121 neighbors, 3 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 121/121 6.3 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 22.6 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 147.0        
                                                                 configs/s    
[589s] Generation 11 complete: error=31 ok=93 min=0.0378 mid=0.0534 max=0.3128 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[589s] Generation 12 starting: 120 neighbors, 3 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 120/120 6.3 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 120/120 22.6 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 148.6        
                                                                 configs/s    
[623s] Generation 12 complete: error=31 ok=92 min=0.0378 mid=0.0535 max=0.3110 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[623s] Generation 13 starting: 118 neighbors, 3 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 9.3 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 118/118 23.2 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 155.7        
                                                                 configs/s    
[650s] Generation 13 complete: error=31 ok=90 min=0.0378 mid=0.0536 max=0.3124 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[650s] Generation 14 starting: 109 neighbors, 3 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 109/109 7.1 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 109/109 21.7 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 163.0        
                                                                 configs/s    
[679s] Generation 14 complete: error=24 ok=88 min=0.0378 mid=0.0532 max=0.2336 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[679s] Generation 15 starting: 113 neighbors, 3 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 113/113 8.3 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 113/113 21.7 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 152.9        
                                                                 configs/s    
[709s] Generation 15 complete: error=24 ok=92 min=0.0377 mid=0.0482 max=0.0854 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[710s] Generation 16 starting: 79 neighbors, 2 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 79/79 9.4 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 79/79 20.2 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 213.6        
                                                                 configs/s    
[729s] Generation 16 complete: error=11 ok=70 min=0.0383 mid=0.0474 max=0.1378 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 1], range_warp_specializes=[], waves_per_eu=1)
[729s] Generation 17 starting: 83 neighbors, 2 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 83/83 8.9 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 83/83 20.0 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 209.3        
                                                                 configs/s    
[750s] Generation 17 complete: error=11 ok=74 min=0.0379 mid=0.0479 max=0.1394 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[750s] Generation 18 starting: 35 neighbors, 1 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 35/35 7.8 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 35/35 25.3 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 584.8        
                                                                 configs/s    
[759s] Generation 18 complete: error=11 ok=25 min=0.0376 mid=0.0404 max=0.0682 best=Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[759s] Autotuning complete in 759.9s after searching 2642 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 128, 128], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 11:
(M, K, N)
------------------
(1664, 1792, 1920)
 60%|██████    | 12/20 [1:53:44<1:17:42, 582.83s/it]WARNING:tritonbench.utils.triton_op:Running input ID 12:
(M, K, N)
------------------
(1792, 1920, 2048)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_460", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.03812599927186966, "best_triton_pos": 0}
AUTOTUNE mm(1792x1920, 1920x2048)
strides: [1920, 1], [2048, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_460 0.0381 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_459 0.0418 ms 91.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_462 0.0435 ms 87.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_443 0.0441 ms 86.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_458 0.0448 ms 85.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_453 0.0460 ms 82.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_446 0.0468 ms 81.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_466 0.0477 ms 79.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_448 0.0486 ms 78.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_452 0.0501 ms 76.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.5417 seconds and 0.8989 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2079.71ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 70.15ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1792, 1920),
              'stride': (1920, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (1920, 2048),
              'stride': (2048, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 12.88ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[70s] Timeout after 60s compiling Config(block_sizes=[2, 32, 2048], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[True, False], range_num_stages=[3, 3], range_unroll_factors=[2, 4], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━━━ 100/100 - configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 2.2 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 3929.1 configs/s
[106s] Initial random population of 100, 5 starting points: error=33 timeout=1 ok=66 min=0.1653 mid=3.4896 max=893.6480 best=Config(block_sizes=[16, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[106s] Generation 1 starting: 223 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 223/223 8.1 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 223/223 18.3 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 692.8         
                                                                configs/s     
[151s] Generation 1 complete: error=11 ok=217 min=0.0684 mid=0.1894 max=0.9187 best=Config(block_sizes=[32, 64, 32], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[151s] Generation 2 starting: 191 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 191/191 6.4 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 191/191 18.4 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 102.5         
                                                                configs/s     
[205s] Generation 2 complete: error=12 ok=184 min=0.0553 mid=0.0962 max=0.5557 best=Config(block_sizes=[256, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[205s] Generation 3 starting: 181 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 181/181 7.7 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 181/181 18.8 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 77.2         
                                                                 configs/s    
[257s] Generation 3 complete: error=14 ok=172 min=0.0546 mid=0.0766 max=0.2745 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[257s] Generation 4 starting: 187 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 187/187 7.9 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 187/187 18.0 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 81.7         
                                                                 configs/s    
[308s] Generation 4 complete: error=10 ok=182 min=0.0468 mid=0.0682 max=0.2527 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[308s] Generation 5 starting: 198 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 198/198 7.8 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 18.2 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 80.8         
                                                                 configs/s    
[361s] Generation 5 complete: error=11 ok=192 min=0.0463 mid=0.0656 max=0.2072 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[361s] Generation 6 starting: 204 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 204/204 8.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 204/204 19.3 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 87.2         
                                                                 configs/s    
[413s] Generation 6 complete: error=21 ok=188 min=0.0465 mid=0.0665 max=0.2121 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[413s] Generation 7 starting: 196 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 196/196 8.0 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 196/196 19.1 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 90.7         
                                                                 configs/s    
[463s] Generation 7 complete: error=21 ok=180 min=0.0460 mid=0.0651 max=0.2098 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[463s] Generation 8 starting: 202 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 202/202 8.0 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 202/202 19.1 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 88.5         
                                                                 configs/s    
[515s] Generation 8 complete: error=22 ok=185 min=0.0464 mid=0.0652 max=0.2096 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[515s] Generation 9 starting: 156 neighbors, 4 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 156/156 8.6 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 156/156 19.5 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 92.1         
                                                                 configs/s    
[555s] Generation 9 complete: error=14 ok=146 min=0.0463 mid=0.0634 max=0.1958 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[555s] Generation 10 starting: 151 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 151/151 5.7 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 151/151 16.0 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 85.0         
                                                                 configs/s    
[606s] Generation 10 complete: error=19 ok=136 min=0.0462 mid=0.0604 max=0.2281 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[606s] Generation 11 starting: 121 neighbors, 3 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 121/121 5.4 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 18.4 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 109.5        
                                                                 configs/s    
[648s] Generation 11 complete: error=7 ok=118 min=0.0460 mid=0.0615 max=0.2284 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[648s] Generation 12 starting: 117 neighbors, 3 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 117/117 8.5 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 19.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.8        
                                                                 configs/s    
[679s] Generation 12 complete: error=7 ok=114 min=0.0460 mid=0.0615 max=0.2284 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[679s] Generation 13 starting: 118 neighbors, 3 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 5.2 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 118/118 18.5 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.2        
                                                                 configs/s    
[720s] Generation 13 complete: error=7 ok=115 min=0.0461 mid=0.0611 max=0.2644 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[720s] Generation 14 starting: 120 neighbors, 3 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 120/120 5.2 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 120/120 18.6 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 110.8        
                                                                 configs/s    
[763s] Generation 14 complete: error=8 ok=116 min=0.0458 mid=0.0611 max=0.2643 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[763s] Generation 15 starting: 118 neighbors, 3 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 118/118 8.5 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 118/118 18.9 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.1        
                                                                 configs/s    
[795s] Generation 15 complete: error=8 ok=114 min=0.0458 mid=0.0612 max=0.2640 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[795s] Generation 16 starting: 117 neighbors, 3 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 117/117 5.1 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 18.6 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 114.7        
                                                                 configs/s    
[836s] Generation 16 complete: error=8 ok=113 min=0.0458 mid=0.0613 max=0.2644 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[836s] Generation 17 starting: 114 neighbors, 3 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 114/114 8.5 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 114/114 19.0 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 119.0        
                                                                 configs/s    
[867s] Generation 17 complete: error=8 ok=110 min=0.0456 mid=0.0613 max=0.2646 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[867s] Generation 18 starting: 112 neighbors, 3 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 112/112 6.9 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 112/112 18.2 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.4        
                                                                 configs/s    
[901s] Generation 18 complete: error=4 ok=112 min=0.0456 mid=0.0609 max=0.2668 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[901s] Generation 19 starting: 104 neighbors, 3 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 104/104 8.2 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 104/104 18.0 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 120.1        
                                                                 configs/s    
[931s] Generation 19 complete: error=2 ok=106 min=0.0458 mid=0.0581 max=0.1551 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[931s] Generation 20 starting: 106 neighbors, 3 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 106/106 8.1 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 106/106 13.7 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 127.5        
                                                                 configs/s    
[962s] Generation 20 complete: error=2 ok=108 min=0.0458 mid=0.0568 max=0.1678 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[963s] Autotuning complete in 963.1s after searching 3135 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 12:
(M, K, N)
------------------
(1792, 1920, 2048)
 65%|██████▌   | 13/20 [2:09:51<1:21:35, 699.29s/it]WARNING:tritonbench.utils.triton_op:Running input ID 13:
(M, K, N)
------------------
(2048, 2176, 2304)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_496", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.05171800032258034, "best_triton_pos": 0}
AUTOTUNE mm(2048x2176, 2176x2304)
strides: [2176, 1], [2304, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_496 0.0517 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_495 0.0525 ms 98.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_498 0.0529 ms 97.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_489 0.0530 ms 97.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_482 0.0531 ms 97.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_494 0.0534 ms 96.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_502 0.0544 ms 95.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_484 0.0585 ms 88.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_491 0.0598 ms 86.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_485 0.0609 ms 84.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.6284 seconds and 0.8985 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2183.34ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.58ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2048, 2176),
              'stride': (2176, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2176, 2304),
              'stride': (2304, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 6.87ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[71s] Timeout after 60s compiling Config(block_sizes=[1, 32, 4096], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=7, num_warps=8, pid_type='persistent_blocked', range_flattens=[True, False], range_multi_buffers=[False, True], range_num_stages=[4, 0], range_unroll_factors=[4, 2], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.1 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 1.2 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━ 1000/1000 8298.1 configs/s
[147s] Initial random population of 100, 5 starting points: error=30 timeout=1 ok=69 min=0.1705 mid=3.6044 max=2514.2695 best=Config(block_sizes=[32, 256, 16], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[False, True], range_num_stages=[1, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[147s] Generation 1 starting: 215 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 215/215 7.8 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 215/215 18.0 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 584.9         
                                                                configs/s     
[192s] Generation 1 complete: error=8 ok=212 min=0.1045 mid=0.2607 max=3.4502 best=Config(block_sizes=[64, 256, 32], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[False, True], range_num_stages=[1, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[192s] Generation 2 starting: 192 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 192/192 6.5 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 192/192 17.7 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 173.1         
                                                                configs/s     
[243s] Generation 2 complete: error=6 ok=191 min=0.0680 mid=0.1144 max=1.4360 best=Config(block_sizes=[64, 256, 32], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[False, True], range_num_stages=[1, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[243s] Generation 3 starting: 192 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 192/192 5.9 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 192/192 18.4 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 61.6         
                                                                 configs/s    
[306s] Generation 3 complete: error=14 ok=183 min=0.0674 mid=0.0975 max=0.2993 best=Config(block_sizes=[128, 128, 32], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=4, pid_type='persistent_blocked', range_flattens=[None, True], range_multi_buffers=[False, True], range_num_stages=[1, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[306s] Generation 4 starting: 204 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 204/204 7.5 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 204/204 19.1 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 67.0         
                                                                 configs/s    
[366s] Generation 4 complete: error=20 ok=189 min=0.0597 mid=0.0837 max=0.2649 best=Config(block_sizes=[64, 256, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[366s] Generation 5 starting: 213 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 213/213 7.1 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 213/213 19.6 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 53.9         
                                                                 configs/s    
[430s] Generation 5 complete: error=22 ok=196 min=0.0591 mid=0.0771 max=0.5976 best=Config(block_sizes=[64, 256, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[430s] Generation 6 starting: 207 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 207/207 7.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 207/207 19.9 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 57.9         
                                                                 configs/s    
[491s] Generation 6 complete: error=23 ok=189 min=0.0561 mid=0.0712 max=0.2830 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[491s] Generation 7 starting: 214 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 214/214 7.8 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 214/214 19.9 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 57.1         
                                                                 configs/s    
[554s] Generation 7 complete: error=19 ok=200 min=0.0560 mid=0.0671 max=0.1685 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, None], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[554s] Generation 8 starting: 204 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 204/204 7.7 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 204/204 20.0 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 60.7         
                                                                 configs/s    
[612s] Generation 8 complete: error=20 ok=189 min=0.0556 mid=0.0712 max=0.1650 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, False], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[612s] Generation 9 starting: 206 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 206/206 7.6 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 206/206 20.9 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 64.0         
                                                                 configs/s    
[669s] Generation 9 complete: error=29 ok=182 min=0.0556 mid=0.0711 max=0.1655 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[669s] Generation 10 starting: 167 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 167/167 7.7 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 167/167 19.7 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 74.7         
                                                                 configs/s    
[717s] Generation 10 complete: error=12 ok=160 min=0.0554 mid=0.0715 max=0.1656 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[717s] Generation 11 starting: 155 neighbors, 4 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 155/155 7.6 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 155/155 20.4 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 81.0         
                                                                 configs/s    
[764s] Generation 11 complete: error=18 ok=142 min=0.0553 mid=0.0708 max=0.1660 best=Config(block_sizes=[128, 128, 64], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=8, pid_type='persistent_interleaved', range_flattens=[False, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[1, 0], range_warp_specializes=[], waves_per_eu=1)
[764s] Generation 12 starting: 121 neighbors, 3 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 121/121 7.6 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 20.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 106.0        
                                                                 configs/s    
[798s] Generation 12 complete: error=13 ok=111 min=0.0554 mid=0.0714 max=0.1431 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[799s] Generation 13 starting: 125 neighbors, 3 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 125/125 7.5 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 125/125 20.2 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 102.8        
                                                                 configs/s    
[835s] Generation 13 complete: error=13 ok=115 min=0.0551 mid=0.0713 max=0.1426 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[835s] Generation 14 starting: 127 neighbors, 3 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 127/127 7.4 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 127/127 20.2 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 98.9         
                                                                 configs/s    
[871s] Generation 14 complete: error=13 ok=117 min=0.0549 mid=0.0713 max=0.1434 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, None], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[871s] Generation 15 starting: 127 neighbors, 3 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 127/127 7.6 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 127/127 19.9 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 100.8        
                                                                 configs/s    
[908s] Generation 15 complete: error=13 ok=117 min=0.0546 mid=0.0712 max=0.1426 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[0, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[908s] Generation 16 starting: 123 neighbors, 3 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 123/123 7.5 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 20.0 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 103.8        
                                                                 configs/s    
[946s] Generation 16 complete: error=13 ok=113 min=0.0546 mid=0.0713 max=0.1428 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[1, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[946s] Generation 17 starting: 126 neighbors, 3 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 126/126 7.5 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 126/126 20.2 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 101.8        
                                                                 configs/s    
[982s] Generation 17 complete: error=13 ok=116 min=0.0545 mid=0.0714 max=0.1426 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[982s] Generation 18 starting: 126 neighbors, 3 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 126/126 7.5 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 126/126 20.0 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 100.4        
                                                                 configs/s    
[1019s] Generation 18 complete: error=13 ok=116 min=0.0548 mid=0.0714 max=0.1423 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1019s] Generation 19 starting: 83 neighbors, 2 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 83/83 7.7 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 83/83 19.2 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 146.8        
                                                                 configs/s    
[1043s] Generation 19 complete: error=2 ok=84 min=0.0545 mid=0.0725 max=0.1424 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1043s] Generation 20 starting: 79 neighbors, 2 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 79/79 7.4 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 79/79 18.4 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 157.1        
                                                                 configs/s    
[1067s] Generation 20 complete: error=2 ok=80 min=0.0545 mid=0.0726 max=0.1426 best=Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1067s] Autotuning complete in 1067.8s after searching 3305 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='persistent_interleaved', range_flattens=[None, True], range_multi_buffers=[True, True], range_num_stages=[2, 0], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 13:
(M, K, N)
------------------
(2048, 2176, 2304)
 70%|███████   | 14/20 [2:27:43<1:21:11, 811.88s/it]WARNING:tritonbench.utils.triton_op:Running input ID 14:
(M, K, N)
------------------
(2176, 2304, 2432)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_534", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.06286299973726273, "best_triton_pos": 0}
AUTOTUNE mm(2176x2304, 2304x2432)
strides: [2304, 1], [2432, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_534 0.0629 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_530 0.0665 ms 94.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_518 0.0670 ms 93.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_538 0.0694 ms 90.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_527 0.0731 ms 86.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_533 0.0819 ms 76.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_531 0.0872 ms 72.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_524 0.0875 ms 71.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_515 0.0876 ms 71.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_536 0.0877 ms 71.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.7259 seconds and 0.8421 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2206.40ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 70.49ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2176, 2304),
              'stride': (2304, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2304, 2432),
              'stride': (2432, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 15.55ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[63s] Timeout after 60s compiling Config(block_sizes=[16, 1, 2048], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='persistent_blocked', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[1, 3], range_unroll_factors=[4, 4], range_warp_specializes=[], waves_per_eu=1)
[64s] Timeout after 60s compiling Config(block_sizes=[1024, 1, 512], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[3, 2], range_warp_specializes=[], waves_per_eu=1)
[68s] Timeout after 60s compiling Config(block_sizes=[4, 2, 4096], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=8, num_warps=16, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[71s] Timeout after 60s compiling Config(block_sizes=[2048, 1, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=1, pid_type='persistent_blocked', range_flattens=[True, None], range_multi_buffers=[True, None], range_num_stages=[3, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.2 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 0.9 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━━━ 848/848 5230.2 configs/s
[152s] Initial random population of 100, 5 starting points: error=17 timeout=4 ok=79 min=0.2445 mid=3.9688 max=2815.0056 best=Config(block_sizes=[512, 64, 16], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=16, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[152s] Generation 1 starting: 217 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 217/217 4.4 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 217/217 18.0 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 1186.5       
                                                                 configs/s    
[219s] Generation 1 complete: error=12 ok=210 min=0.1023 mid=0.3431 max=7.3434 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[219s] Generation 2 starting: 185 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 185/185 4.5 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 185/185 18.0 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 137.7         
                                                                configs/s     
[282s] Generation 2 complete: error=5 ok=185 min=0.1014 mid=0.1681 max=2.6544 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[282s] Generation 3 starting: 176 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 176/176 4.5 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 176/176 18.2 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 72.5         
                                                                 configs/s    
[351s] Generation 3 complete: error=8 ok=173 min=0.0857 mid=0.1355 max=3.4492 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[351s] Generation 4 starting: 189 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 189/189 4.5 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 189/189 19.4 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 85.3         
                                                                 configs/s    
[420s] Generation 4 complete: error=18 ok=176 min=0.0843 mid=0.1480 max=3.4485 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[420s] Generation 5 starting: 196 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 196/196 4.5 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 196/196 18.5 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 76.1         
                                                                 configs/s    
[493s] Generation 5 complete: error=13 ok=188 min=0.0839 mid=0.1324 max=3.2795 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[493s] Generation 6 starting: 159 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 159/159 4.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 159/159 18.3 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 73.8         
                                                                 configs/s    
[555s] Generation 6 complete: error=6 ok=157 min=0.0852 mid=0.1263 max=3.1437 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[555s] Generation 7 starting: 161 neighbors, 4 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 161/161 4.6 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 161/161 18.0 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 58.9         
                                                                 configs/s    
[622s] Generation 7 complete: error=3 ok=162 min=0.0846 mid=0.1161 max=2.8864 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[622s] Generation 8 starting: 124 neighbors, 3 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 124/124 4.6 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 124/124 18.3 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 76.2         
                                                                 configs/s    
[676s] Generation 8 complete: error=3 ok=125 min=0.0833 mid=0.1150 max=2.8892 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[676s] Generation 9 starting: 115 neighbors, 3 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 115/115 4.6 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 115/115 18.0 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 88.4         
                                                                 configs/s    
[723s] Generation 9 complete: error=3 ok=115 min=0.0818 mid=0.1159 max=2.8883 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[723s] Generation 10 starting: 123 neighbors, 3 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 123/123 4.6 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 17.9 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 82.6         
                                                                 configs/s    
[774s] Generation 10 complete: error=3 ok=123 min=0.0815 mid=0.1160 max=2.8873 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[774s] Generation 11 starting: 124 neighbors, 3 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 124/124 4.6 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 124/124 17.9 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 82.8         
                                                                 configs/s    
[825s] Generation 11 complete: error=3 ok=124 min=0.0818 mid=0.1160 max=2.8889 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[825s] Generation 12 starting: 123 neighbors, 3 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 123/123 4.6 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 18.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 84.7         
                                                                 configs/s    
[875s] Generation 12 complete: error=3 ok=123 min=0.0817 mid=0.1164 max=2.7344 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[875s] Generation 13 starting: 122 neighbors, 3 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 122/122 4.6 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 17.9 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 85.4         
                                                                 configs/s    
[925s] Generation 13 complete: error=3 ok=122 min=0.0815 mid=0.1160 max=2.7328 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[925s] Generation 14 starting: 119 neighbors, 3 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 119/119 4.5 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 119/119 18.0 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 77.7         
                                                                 configs/s    
[978s] Generation 14 complete: error=3 ok=119 min=0.0815 mid=0.1112 max=2.7081 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[978s] Generation 15 starting: 117 neighbors, 3 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 117/117 4.6 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 117/117 17.8 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 79.5         
                                                                 configs/s    
[1028s] Generation 15 complete: error=3 ok=117 min=0.0816 mid=0.1092 max=2.7913 best=Config(block_sizes=[128, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1028s] Generation 16 starting: 122 neighbors, 3 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 122/122 4.3 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 18.2 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 77.8         
                                                                 configs/s    
[1079s] Generation 16 complete: error=3 ok=122 min=0.0806 mid=0.1102 max=2.7922 best=Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1079s] Generation 17 starting: 122 neighbors, 3 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 122/122 4.5 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 17.9 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 76.4         
                                                                 configs/s    
[1131s] Generation 17 complete: error=3 ok=122 min=0.0799 mid=0.1098 max=2.7892 best=Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1131s] Generation 18 starting: 85 neighbors, 2 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 85/85 4.3 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 85/85 18.6 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 112.4        
                                                                 configs/s    
[1167s] Generation 18 complete: error=3 ok=84 min=0.0799 mid=0.1115 max=2.7888 best=Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1167s] Generation 19 starting: 84 neighbors, 2 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 84/84 4.7 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 84/84 18.0 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 113.6        
                                                                 configs/s    
[1203s] Generation 19 complete: error=3 ok=83 min=0.0801 mid=0.1116 max=2.7918 best=Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1203s] Generation 20 starting: 48 neighbors, 1 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 48/48 3.7 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 48/48 18.0 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 212.2        
                                                                 configs/s    
[1227s] Generation 20 complete: error=3 ok=47 min=0.0931 mid=0.1089 max=2.7301 best=Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[1227s] Autotuning complete in 1227.1s after searching 2807 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 64, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['first', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 14:
(M, K, N)
------------------
(2176, 2304, 2432)
 75%|███████▌  | 15/20 [2:48:15<1:18:11, 938.34s/it]WARNING:tritonbench.utils.triton_op:Running input ID 15:
(M, K, N)
------------------
(2304, 2432, 2560)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_570", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.06298299878835678, "best_triton_pos": 0}
AUTOTUNE mm(2304x2432, 2432x2560)
strides: [2432, 1], [2560, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_570 0.0630 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_574 0.0662 ms 95.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_566 0.0704 ms 89.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_563 0.0765 ms 82.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_572 0.0815 ms 77.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_569 0.0830 ms 75.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_554 0.0834 ms 75.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_575 0.0922 ms 68.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_551 0.0922 ms 68.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=64, BLOCK_N=64, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_560 0.0944 ms 66.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.7703 seconds and 0.9243 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2338.71ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.94ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2304, 2432),
              'stride': (2432, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2432, 2560),
              'stride': (2560, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 15.35ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[64s] Timeout after 60s compiling Config(block_sizes=[16, 1, 2048], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='persistent_blocked', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[1, 3], range_unroll_factors=[4, 4], range_warp_specializes=[], waves_per_eu=1)
[66s] Timeout after 60s compiling Config(block_sizes=[1024, 1, 512], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[3, 2], range_warp_specializes=[], waves_per_eu=1)
[72s] Timeout after 60s compiling Config(block_sizes=[4, 2, 4096], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=8, num_warps=16, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[77s] Timeout after 60s compiling Config(block_sizes=[2048, 1, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=1, pid_type='persistent_blocked', range_flattens=[True, None], range_multi_buffers=[True, None], range_num_stages=[3, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.2 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 0.4 configs/s
[168s] Initial random population of 100, 5 starting points: error=17 timeout=4 ok=79 min=0.2082 mid=4.6907 max=3150.9504 best=Config(block_sizes=[512, 64, 16], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=16, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[168s] Generation 1 starting: 213 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 213/213 6.9 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 213/213 17.9 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 1211.8       
                                                                 configs/s    
[218s] Generation 1 complete: error=10 ok=208 min=0.1090 mid=0.4309 max=5.3716 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[218s] Generation 2 starting: 185 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 185/185 6.7 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 185/185 18.0 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 89.5         
                                                                 configs/s    
[271s] Generation 2 complete: error=6 ok=184 min=0.1072 mid=0.1790 max=1.2564 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[271s] Generation 3 starting: 184 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 184/184 6.6 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 184/184 18.2 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 50.8         
                                                                 configs/s    
[334s] Generation 3 complete: error=9 ok=180 min=0.1067 mid=0.1389 max=3.6403 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[334s] Generation 4 starting: 190 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 190/190 6.8 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 190/190 18.1 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 49.8         
                                                                 configs/s    
[397s] Generation 4 complete: error=6 ok=189 min=0.0986 mid=0.1250 max=3.4477 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[397s] Generation 5 starting: 183 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 183/183 6.8 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 183/183 18.4 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 54.3         
                                                                 configs/s    
[457s] Generation 5 complete: error=8 ok=180 min=0.0959 mid=0.1242 max=3.4482 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[457s] Generation 6 starting: 152 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 152/152 6.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 152/152 18.4 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 69.7         
                                                                 configs/s    
[509s] Generation 6 complete: error=7 ok=149 min=0.0975 mid=0.1308 max=3.4470 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[509s] Generation 7 starting: 78 neighbors, 2 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 78/78 6.5 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 78/78 18.3 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 102.3         
                                                                configs/s     
[538s] Generation 7 complete: error=3 ok=77 min=0.0973 mid=0.1208 max=3.4476 best=Config(block_sizes=[64, 64, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[538s] Generation 8 starting: 40 neighbors, 1 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 40/40 6.2 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 40/40 17.8 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 197.2         
                                                                configs/s     
[554s] Generation 8 complete: error=2 ok=40 min=0.1045 mid=0.1143 max=3.0242 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[554s] Generation 9 starting: 34 neighbors, 1 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━ 34/34 5.8 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━━━ 34/34 17.7 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 231.9         
                                                                configs/s     
[567s] Generation 9 complete: error=2 ok=33 min=0.1063 mid=0.1076 max=4.2017 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[567s] Generation 10 starting: 38 neighbors, 1 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 6.1 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 17.7 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 225.4        
                                                                 configs/s    
[582s] Generation 10 complete: error=2 ok=37 min=0.1063 mid=0.1091 max=4.2054 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[582s] Generation 11 starting: 40 neighbors, 1 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 40/40 7.3 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 40/40 18.0 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 217.8        
                                                                 configs/s    
[596s] Generation 11 complete: error=1 ok=40 min=0.0864 mid=0.1101 max=4.2071 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[596s] Generation 12 starting: 40 neighbors, 1 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 40/40 6.4 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 40/40 21.9 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 272.5        
                                                                 configs/s    
[610s] Generation 12 complete: error=8 ok=33 min=0.0807 mid=0.0911 max=0.1446 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[610s] Generation 13 starting: 40 neighbors, 1 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 40/40 6.4 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 40/40 22.4 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 253.4        
                                                                 configs/s    
[624s] Generation 13 complete: error=8 ok=33 min=0.0803 mid=0.0829 max=0.1404 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[624s] Generation 14 starting: 39 neighbors, 1 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 6.4 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 22.4 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 276.3        
                                                                 configs/s    
[638s] Generation 14 complete: error=8 ok=32 min=0.0805 mid=0.0876 max=0.1412 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[638s] Generation 15 starting: 39 neighbors, 1 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 6.4 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 22.5 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 276.8        
                                                                 configs/s    
[651s] Generation 15 complete: error=8 ok=32 min=0.0806 mid=0.0887 max=0.1421 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[651s] Generation 16 starting: 39 neighbors, 1 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 6.4 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 22.5 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 259.1        
                                                                 configs/s    
[665s] Generation 16 complete: error=8 ok=32 min=0.0798 mid=0.0878 max=0.1407 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[665s] Generation 17 starting: 38 neighbors, 1 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 6.4 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 22.6 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 293.0        
                                                                 configs/s    
[678s] Generation 17 complete: error=8 ok=31 min=0.0803 mid=0.0890 max=0.1411 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[678s] Generation 18 starting: 38 neighbors, 1 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 6.4 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 22.7 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 285.3        
                                                                 configs/s    
[691s] Generation 18 complete: error=8 ok=31 min=0.0803 mid=0.0885 max=0.1389 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[692s] Generation 19 starting: 38 neighbors, 1 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 38/38 6.3 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 38/38 22.6 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 285.0        
                                                                 configs/s    
[705s] Generation 19 complete: error=8 ok=31 min=0.0803 mid=0.0886 max=0.1417 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[705s] Generation 20 starting: 39 neighbors, 1 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━━ 39/39 6.3 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━━━ 39/39 22.4 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 275.0        
                                                                 configs/s    
[718s] Generation 20 complete: error=8 ok=32 min=0.0805 mid=0.0890 max=0.1417 best=Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[718s] Autotuning complete in 718.9s after searching 1783 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[128, 256, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=8, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 15:
(M, K, N)
------------------
(2304, 2432, 2560)
 80%|████████  | 16/20 [3:00:18<58:14, 873.61s/it]  WARNING:tritonbench.utils.triton_op:Running input ID 16:
(M, K, N)
------------------
(2432, 2560, 2688)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_606", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.0757720023393631, "best_triton_pos": 0}
AUTOTUNE mm(2432x2560, 2560x2688)
strides: [2560, 1], [2688, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_606 0.0758 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_602 0.0769 ms 98.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_610 0.0800 ms 94.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_590 0.0820 ms 92.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_599 0.0840 ms 90.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_605 0.0962 ms 78.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_608 0.1004 ms 75.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_604 0.1009 ms 75.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_603 0.1023 ms 74.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_596 0.1031 ms 73.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=64, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
SingleProcess AUTOTUNE benchmarking takes 0.8258 seconds and 0.8329 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2298.61ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 70.04ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2432, 2560),
              'stride': (2560, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2560, 2688),
              'stride': (2688, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 11.69ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[63s] Timeout after 60s compiling Config(block_sizes=[16, 1, 2048], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='persistent_blocked', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[1, 3], range_unroll_factors=[4, 4], range_warp_specializes=[], waves_per_eu=1)
[64s] Timeout after 60s compiling Config(block_sizes=[1024, 1, 512], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[3, 2], range_warp_specializes=[], waves_per_eu=1)
[68s] Timeout after 60s compiling Config(block_sizes=[4, 2, 4096], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=8, num_warps=16, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[72s] Timeout after 60s compiling Config(block_sizes=[2048, 1, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=1, pid_type='persistent_blocked', range_flattens=[True, None], range_multi_buffers=[True, None], range_num_stages=[3, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.2 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 4.8 configs/s
[176s] Initial random population of 100, 5 starting points: error=17 timeout=4 ok=79 min=0.2577 mid=5.4480 max=3425.3921 best=Config(block_sizes=[512, 64, 16], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=16, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[176s] Generation 1 starting: 213 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 213/213 6.6 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 213/213 17.7 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 1422.5       
                                                                 configs/s    
[225s] Generation 1 complete: error=10 ok=208 min=0.1194 mid=0.4686 max=6.1105 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[225s] Generation 2 starting: 185 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 185/185 6.6 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 185/185 18.1 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 131.0         
                                                                configs/s     
[277s] Generation 2 complete: error=6 ok=184 min=0.1175 mid=0.2196 max=1.4679 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[277s] Generation 3 starting: 179 neighbors, 5 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 179/179 6.5 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 179/179 18.5 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 78.1         
                                                                 configs/s    
[331s] Generation 3 complete: error=9 ok=175 min=0.1078 mid=0.1673 max=3.8285 best=Config(block_sizes=[64, 128, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[0, 0], range_warp_specializes=[], waves_per_eu=1)
[331s] Generation 4 starting: 177 neighbors, 5 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 177/177 6.3 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 177/177 18.1 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 50.7         
                                                                 configs/s    
[394s] Generation 4 complete: error=6 ok=176 min=0.1047 mid=0.1437 max=3.6408 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[394s] Generation 5 starting: 198 neighbors, 5 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 198/198 6.3 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 198/198 18.7 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 47.2         
                                                                 configs/s    
[462s] Generation 5 complete: error=9 ok=194 min=0.1043 mid=0.1417 max=3.3802 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[462s] Generation 6 starting: 206 neighbors, 5 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 206/206 6.1 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 206/206 18.9 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 41.2         
                                                                 configs/s    
[538s] Generation 6 complete: error=12 ok=199 min=0.1039 mid=0.1382 max=3.0266 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[538s] Generation 7 starting: 207 neighbors, 5 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 207/207 6.4 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 207/207 15.6 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 35.5         
                                                                 configs/s    
[618s] Generation 7 complete: error=12 ok=200 min=0.1031 mid=0.1362 max=3.0263 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[618s] Generation 8 starting: 185 neighbors, 5 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 185/185 6.1 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 185/185 18.4 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 40.4         
                                                                 configs/s    
[689s] Generation 8 complete: error=6 ok=184 min=0.1029 mid=0.1289 max=3.0269 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[689s] Generation 9 starting: 193 neighbors, 5 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 193/193 6.3 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 193/193 19.2 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 37.6         
                                                                 configs/s    
[763s] Generation 9 complete: error=13 ok=185 min=0.1034 mid=0.1255 max=0.5756 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=4, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[763s] Generation 10 starting: 193 neighbors, 5 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 193/193 6.3 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 193/193 19.3 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 39.1         
                                                                 configs/s    
[838s] Generation 10 complete: error=14 ok=184 min=0.1030 mid=0.1257 max=0.5776 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[838s] Generation 11 starting: 197 neighbors, 5 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 6.3 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 19.6 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 38.1         
                                                                 configs/s    
[912s] Generation 11 complete: error=14 ok=188 min=0.1019 mid=0.1242 max=0.5772 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[912s] Generation 12 starting: 197 neighbors, 5 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 6.2 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 19.0 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 38.7         
                                                                 configs/s    
[987s] Generation 12 complete: error=14 ok=188 min=0.1020 mid=0.1244 max=0.5925 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[987s] Generation 13 starting: 195 neighbors, 5 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 195/195 6.3 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 195/195 19.3 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 39.0         
                                                                 configs/s    
[1060s] Generation 13 complete: error=14 ok=186 min=0.1013 mid=0.1240 max=0.5973 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1060s] Generation 14 starting: 195 neighbors, 5 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 195/195 6.2 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 195/195 19.1 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 39.0         
                                                                 configs/s    
[1137s] Generation 14 complete: error=14 ok=186 min=0.1014 mid=0.1243 max=0.5923 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1137s] Generation 15 starting: 190 neighbors, 5 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 190/190 6.2 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 190/190 19.5 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 40.6         
                                                                 configs/s    
[1208s] Generation 15 complete: error=14 ok=181 min=0.1017 mid=0.1249 max=0.5908 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1208s] Generation 16 starting: 196 neighbors, 5 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 196/196 6.2 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 196/196 19.2 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 38.7         
                                                                 configs/s    
[1282s] Generation 16 complete: error=14 ok=187 min=0.1017 mid=0.1242 max=0.5672 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1282s] Generation 17 starting: 197 neighbors, 5 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 6.2 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 19.3 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 38.6         
                                                                 configs/s    
[1357s] Generation 17 complete: error=14 ok=188 min=0.1018 mid=0.1243 max=0.5800 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1357s] Generation 18 starting: 193 neighbors, 5 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 193/193 6.0 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 193/193 19.1 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 39.4         
                                                                 configs/s    
[1434s] Generation 18 complete: error=14 ok=184 min=0.1015 mid=0.1246 max=0.5793 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1434s] Generation 19 starting: 196 neighbors, 5 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 196/196 6.1 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 196/196 19.3 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 39.1         
                                                                 configs/s    
[1509s] Generation 19 complete: error=14 ok=187 min=0.1003 mid=0.1244 max=0.5780 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1509s] Generation 20 starting: 197 neighbors, 5 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 197/197 6.1 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 197/197 19.4 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 38.7         
                                                                 configs/s    
[1583s] Generation 20 complete: error=14 ok=188 min=0.1002 mid=0.1245 max=0.5899 best=Config(block_sizes=[64, 128, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[1583s] Autotuning complete in 1583.9s after searching 3985 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[64, 128, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[2], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=2, num_warps=4, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

WARNING:tritonbench.utils.triton_op:Completed input ID 16:
(M, K, N)
------------------
(2432, 2560, 2688)
 85%|████████▌ | 17/20 [3:26:46<54:25, 1088.52s/it]WARNING:tritonbench.utils.triton_op:Running input ID 17:
(M, K, N)
------------------
(2560, 2688, 2816)
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for torch_matmul
INFO:tritonbench.utils.triton_op:Took 0.00ms to get benchmark function for triton_matmul
INFO:tritonbench.utils.triton_op:Took 0.07ms to get benchmark function for kernelllm_matmul
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for mako_matmul
Autotune Choices Stats:
{"num_choices": 36, "num_triton_choices": 36, "best_kernel": "triton_mm_646", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8", "best_time": 0.07621300220489502, "best_triton_pos": 0}
AUTOTUNE mm(2560x2688, 2688x2816)
strides: [2688, 1], [2816, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_646 0.0762 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_642 0.0769 ms 99.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_638 0.0818 ms 93.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=4
  triton_mm_635 0.0874 ms 87.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_626 0.0947 ms 80.4% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=64, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_641 0.0995 ms 76.6% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=128, BLOCK_N=256, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_647 0.1022 ms 74.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=256, BLOCK_N=256, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_644 0.1023 ms 74.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=256, BLOCK_N=128, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=2, num_stages=2, num_warps=4
  triton_mm_640 0.1030 ms 74.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=128, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
  triton_mm_639 0.1069 ms 71.3% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=128, BLOCK_N=128, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=8
SingleProcess AUTOTUNE benchmarking takes 0.8782 seconds and 0.9031 seconds precompiling for 36 choices
INFO:tritonbench.utils.triton_op:Took 2434.76ms to get benchmark function for torch_compile_max_matmul
INFO:tritonbench.utils.triton_op:Took 69.51ms to get benchmark function for torch_compile_default_matmul
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2560, 2688),
              'stride': (2688, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (2688, 2816),
              'stride': (2816, 1)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 15.79ms to get benchmark function for helion_matmul_tritonbench
[0s] Autotune random seed: 343668009
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
[63s] Timeout after 60s compiling Config(block_sizes=[16, 1, 2048], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['first', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=1, num_warps=2, pid_type='persistent_blocked', range_flattens=[False, True], range_multi_buffers=[True, None], range_num_stages=[1, 3], range_unroll_factors=[4, 4], range_warp_specializes=[], waves_per_eu=1)
[65s] Timeout after 60s compiling Config(block_sizes=[1024, 1, 512], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[16], load_eviction_policies=['last', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=7, num_warps=4, pid_type='persistent_interleaved', range_flattens=[False, None], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[3, 2], range_warp_specializes=[], waves_per_eu=1)
[69s] Timeout after 60s compiling Config(block_sizes=[4, 2, 4096], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['first', 'first'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=8, num_warps=16, pid_type='persistent_blocked', range_flattens=[None, False], range_multi_buffers=[False, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[73s] Timeout after 60s compiling Config(block_sizes=[2048, 1, 64], indexing=['pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=1, num_warps=1, pid_type='persistent_blocked', range_flattens=[True, None], range_multi_buffers=[True, None], range_num_stages=[3, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━━ 100/100 0.2 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 4.4 configs/s
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━━━━━━━━ 719/719 - configs/s
[189s] Initial random population of 100, 5 starting points: error=17 timeout=4 ok=79 min=0.2768 mid=6.2307 max=3806.9971 best=Config(block_sizes=[512, 64, 16], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[32], load_eviction_policies=['', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=16, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[189s] Generation 1 starting: 213 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 213/213 6.0 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 213/213 17.7 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 569.6         
                                                                configs/s     
[243s] Generation 1 complete: error=10 ok=208 min=0.1365 mid=0.6069 max=7.3795 best=Config(block_sizes=[128, 64, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor'], l2_groupings=[8], load_eviction_policies=['last', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=5, num_warps=8, pid_type='persistent_blocked', range_flattens=[False, None], range_multi_buffers=[None, True], range_num_stages=[0, 2], range_unroll_factors=[2, 0], range_warp_specializes=[], waves_per_eu=1)
[243s] Generation 2 starting: 185 neighbors, 5 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━━ 185/185 6.0 configs/s
 85%|████████▌ | 17/20 [3:31:37<37:20, 746.93s/it] 
WARNING:tritonbench.utils.triton_op:Caught exception on backend helion_matmul_tritonbench, terminating early with partial results
RuntimeError: Triton Error [HIP]:  Code: 209, Messsage: no kernel image is available for execution on the device

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1149, in run
    y_vals: Dict[str, BenchmarkOperatorMetrics] = functools.reduce(
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1130, in _reduce_benchmarks
    acc[bm_name] = self._do_bench(
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1714, in _do_bench
    metrics.latency = do_bench_wrapper(
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/components/do_bench/run.py", line 738, in do_bench_wrapper
    raise e
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/components/do_bench/run.py", line 728, in do_bench_wrapper
    times=bench_fn(
  File "/home/hotaisle/KernelGeneration/myenv/lib/python3.10/site-packages/triton/testing.py", line 149, in do_bench
    fn()
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/operators/bf16_matmul/matmul_helion.py", line 35, in <lambda>
    return lambda: matmul(a, b)
  File "/home/hotaisle/KernelGeneration/helion/helion/runtime/kernel.py", line 340, in __call__
    return self.bind(args)(*args)
  File "/home/hotaisle/KernelGeneration/helion/helion/runtime/kernel.py", line 714, in __call__
    self.autotune(args, force=False)
  File "/home/hotaisle/KernelGeneration/helion/helion/runtime/kernel.py", line 590, in autotune
    config = self.settings.autotuner_fn(self, args, **kwargs).autotune(
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/base_cache.py", line 181, in autotune
    return self.autotuner.autotune()
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/base_search.py", line 667, in autotune
    best = self._autotune()
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/pattern_search.py", line 107, in _autotune
    self.parallel_benchmark_population(
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/base_search.py", line 853, in parallel_benchmark_population
    results = self.parallel_benchmark([m.config for m in members], desc=desc)
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/base_search.py", line 616, in parallel_benchmark
    perf = self.benchmark_function(config, fn)
  File "/home/hotaisle/KernelGeneration/helion/helion/autotuner/base_search.py", line 452, in benchmark_function
    raise exc.TritonError(
helion.exc.TritonError: Error from Triton code:
Enable HELION_AUTOTUNE_LOG_LEVEL=DEBUG to log generated Triton code.

Error running generated Triton program:
RuntimeError: Triton Error [HIP]:  Code: 209, Messsage: no kernel image is available for execution on the device
@helion.kernel(config=helion.Config(block_sizes=[64, 32, 16], indexing=['pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[1], load_eviction_policies=['last', ''], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=2, num_warps=1, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, False], range_num_stages=[0, 4], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)
Set autotune_ignore_errors=True or HELION_AUTOTUNE_IGNORE_ERRORS=1 to ignore Triton errors in autotuning.
WARNING:tritonbench.utils.triton_op:Failing input: --input-id 17 --num-inputs 1 --input-sample-mode first-k
INFO:tritonbench.utils.run_utils:[tritonbench] Output result csv to /tmp/tmpa3_zep_a.csv
         (M, K, N)    torch_matmul-latency    torch_matmul-tflops    triton_matmul-latency    triton_matmul-accuracy    triton_matmul-speedup    triton_matmul-tflops    kernelllm_matmul-latency    kernelllm_matmul-accuracy    kernelllm_matmul-speedup    kernelllm_matmul-tflops    mako_matmul-latency    mako_matmul-accuracy    mako_matmul-speedup    mako_matmul-tflops    torch_compile_max_matmul-latency    torch_compile_max_matmul-accuracy    torch_compile_max_matmul-speedup    torch_compile_max_matmul-tflops    torch_compile_default_matmul-latency    torch_compile_default_matmul-accuracy    torch_compile_default_matmul-speedup    torch_compile_default_matmul-tflops    helion_matmul_tritonbench-latency    helion_matmul_tritonbench-accuracy    helion_matmul_tritonbench-speedup    helion_matmul_tritonbench-tflops
------------------  ----------------------  ---------------------  -----------------------  ------------------------  -----------------------  ----------------------  --------------------------  ---------------------------  --------------------------  -------------------------  ---------------------  ----------------------  ---------------------  --------------------  ----------------------------------  -----------------------------------  ----------------------------------  ---------------------------------  --------------------------------------  ---------------------------------------  --------------------------------------  -------------------------------------  -----------------------------------  ------------------------------------  -----------------------------------  ----------------------------------
   (256, 384, 512)       0.008018 (±7.01%)                12.5547       0.034759 (±14.53%)                         1                 0.230674                 2.89604          0.079140 (±10.43%)                            1                   0.101314                     1.27196      0.022691 (±2.48%)                       1               0.353356               4.43627                  0.052960 (±14.38%)                                    1                            0.151397                            1.90074                      0.068476 (±11.01%)                                        1                                0.117092                                1.47005                   0.038928 (±13.18%)                                     1                             0.20597                              2.58588
   (384, 512, 640)      0.008339 (±13.47%)                30.1785       0.035801 (±14.00%)                         1                 0.232926                 7.02936           0.083791 (±9.71%)                            1                   0.0995214                    3.0034       0.025057 (±8.48%)                       1               0.332801              10.0434                   0.056047 (±13.09%)                                    1                            0.148786                            4.49013                      0.069638 (±11.97%)                                        1                                0.119748                                3.61381                   0.039770 (±13.11%)                                     1                             0.209681                             6.32784
   (512, 640, 768)      0.009461 (±13.15%)                53.1991       0.036644 (±14.00%)                         1                 0.258187                13.7353           0.084071 (±10.11%)                            1                   0.112536                     5.9868       0.030991 (±3.75%)                       1               0.305282              16.2407                   0.056368 (±13.65%)                                    1                            0.167843                            8.92912                      0.070199 (±10.51%)                                        1                                0.134774                                7.16985                   0.039049 (±12.32%)                                     1                             0.242285                            12.8894
   (640, 768, 896)      0.010424 (±11.15%)                84.4977       0.036643 (±14.55%)                         1                 0.284475                24.0374           0.083750 (±10.48%)                            1                   0.124466                    10.5171       0.034558 (±3.48%)                       1               0.301638              25.4877                   0.056248 (±13.11%)                                    1                            0.185322                           15.6593                       0.069879 (±10.79%)                                        1                                0.149172                               12.6047                    0.039169 (±15.35%)                                     1                             0.266129                            22.4873
  (768, 896, 1024)      0.012629 (±10.79%)               111.591        0.036563 (±14.25%)                         1                 0.345404                38.544             0.084031 (±9.78%)                            1                   0.15029                     16.771        0.039890 (±2.71%)                       1               0.316596              35.3293                   0.056247 (±12.69%)                                    1                            0.224528                           25.0553                       0.070400 (±11.56%)                                        1                                0.179389                               20.0183                    0.038728 (±13.35%)                                     1                             0.326095                            36.3893
 (896, 1024, 1152)       0.013911 (±9.22%)               151.961        0.036843 (±13.71%)                         1                 0.377575                57.3767            0.086557 (±8.98%)                            1                   0.160715                    24.4224       0.044100 (±2.82%)                       1               0.315442              47.9349                   0.056608 (±13.10%)                                    1                            0.245743                           37.3433                        0.071602 (±8.79%)                                        1                                0.194282                               29.5233                    0.038688 (±13.47%)                                     1                             0.359569                            54.6404
(1024, 1152, 1280)       0.016758 (±9.33%)               180.206        0.041093 (±12.88%)                         1                 0.407807                73.4894            0.086997 (±9.40%)                            1                   0.192627                    34.7127       0.049272 (±2.85%)                       1               0.340112              61.2904                   0.056007 (±14.89%)                                    1                            0.299213                           53.92                         0.072726 (±10.25%)                                        1                                0.230427                               41.5243                    0.042016 (±12.40%)                                     1                             0.398848                            71.875
(1152, 1280, 1408)       0.018883 (±7.43%)               219.899        0.043538 (±12.52%)                         1                 0.433713                95.3733            0.087559 (±8.88%)                            1                   0.21566                     47.4236       0.053802 (±2.01%)                       1               0.350972              77.1786                   0.057611 (±14.13%)                                    1                            0.327767                           72.0758                        0.072805 (±9.86%)                                        1                                0.259364                               57.034                     0.044822 (±13.15%)                                     1                             0.421289                            92.6411
(1280, 1408, 1536)      0.022491 (±10.70%)               246.164        0.042617 (±14.77%)                         1                 0.527747               129.913             0.089764 (±9.16%)                            1                   0.250557                    61.6782       0.057290 (±2.24%)                       1               0.392582              96.6396                   0.056809 (±16.37%)                                    1                            0.395906                           97.4578                       0.072805 (±10.35%)                                        1                                0.308921                               76.0453                    0.045223 (±12.94%)                                     1                             0.497335                           122.426
(1408, 1536, 1664)       0.025498 (±8.80%)               282.274        0.042136 (±13.80%)                         1                 0.605136               170.814             0.093171 (±8.56%)                            1                   0.273669                    77.2496       0.063704 (±1.95%)                       1               0.400257             112.982                    0.057209 (±14.09%)                                    1                            0.445699                          125.809                         0.072524 (±8.96%)                                        1                                0.35158                                99.242                     0.046545 (±14.99%)                                     1                             0.547814                           154.634
(1536, 1664, 1792)       0.027662 (±7.10%)               331.153        0.040692 (±19.51%)                         1                 0.67979                225.115             0.091167 (±9.32%)                            1                   0.303421                   100.479        0.066110 (±1.82%)                       1               0.418424             138.562                    0.057290 (±13.37%)                                    1                            0.482842                          159.895                         0.073888 (±8.52%)                                        1                                0.374377                              123.976                     0.045624 (±15.64%)                                     1                             0.606304                           200.779
(1664, 1792, 1920)       0.033115 (±6.05%)               345.778         0.044541 (±5.49%)                         1                 0.743472               257.077             0.090726 (±8.75%)                            1                   0.365                      126.209        0.074369 (±3.07%)                       1               0.44528              153.968                    0.057050 (±11.88%)                                    1                            0.580456                          200.709                         0.074489 (±9.90%)                                        1                                0.444562                              153.72                      0.045583 (±13.72%)                                     1                             0.726477                           251.2
(1792, 1920, 2048)       0.039169 (±9.31%)               359.796         0.049272 (±4.80%)                         1                 0.794954               286.022             0.091608 (±9.63%)                            1                   0.427572                   153.839        0.077817 (±3.09%)                       1               0.503348             181.103                    0.059816 (±12.40%)                                    1                            0.654825                          235.604                         0.074730 (±7.35%)                                        1                                0.52414                               188.584                      0.044902 (±4.55%)                                     1                             0.872322                           313.858
(2048, 2176, 2304)       0.043098 (±5.68%)               476.479         0.057450 (±4.54%)                         1                 0.750183               357.447             0.096579 (±2.62%)                            1                   0.446246                   212.627        0.093251 (±3.31%)                       1               0.462172             220.215                    0.059736 (±16.78%)                                    1                            0.721474                          343.768                        0.079460 (±10.14%)                                        1                                0.542386                              258.436                      0.058934 (±9.39%)                                     1                             0.731293                           348.446
(2176, 2304, 2432)       0.052199 (±9.60%)               467.168         0.076855 (±3.60%)                         1                 0.679188               317.295             0.110330 (±2.00%)                            1                   0.473117                   221.025        0.125725 (±5.42%)                       1               0.415184             193.96                      0.066631 (±6.02%)                                    1                            0.783404                          365.981                        0.079741 (±12.37%)                                        1                                0.654607                              305.811                      0.081064 (±9.25%)                                     1                             0.643923                           300.82
(2304, 2432, 2560)       0.060217 (±7.12%)               476.428         0.069197 (±3.77%)                         1                 0.870226               414.599             0.128572 (±1.84%)                            1                   0.468352                   223.136        0.133102 (±4.49%)                       1               0.452412             215.542                     0.064547 (±9.44%)                                    1                            0.932917                          444.467                        0.077456 (±11.96%)                                        1                                0.777435                              370.391                      0.082066 (±7.18%)                                     1                             0.733763                           349.585
(2432, 2560, 2688)       0.067834 (±7.09%)               493.418         0.089002 (±4.05%)                         1                 0.762163               376.065             0.143085 (±1.96%)                            1                   0.474082                   233.921        0.149219 (±4.00%)                       1               0.454594             224.305                     0.078458 (±4.04%)                                    1                            0.86459                           426.605                        0.075692 (±15.31%)                                        1                                0.896185                              442.194                      0.104397 (±4.69%)                                     1                             0.64977                            320.608
           average    0.027629764367114094               254.279       0.04786152940462617                         1                 0.528448               167.46            0.09475870737258126                            1                   0.272891                    91.4278     0.06711458809235517                       1               0.385909             106.778                    0.0591554120182991                                    1                            0.447807                          154.098                       0.07332411759039935                                        1                                0.368144                              128.903                   0.051500470103586424                                     1                             0.496404                           156.6
Generation 2: exploring neighbors  84% ━━━━━━━━━━━━━    156/185 18.2 configs/s
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:__main__:ignoring torch_matmul-latency
INFO:__main__:ignoring torch_matmul-tflops
INFO:__main__:ignoring triton_matmul-latency
INFO:__main__:ignoring kernelllm_matmul-latency
INFO:__main__:ignoring mako_matmul-latency
INFO:__main__:ignoring torch_compile_max_matmul-latency
INFO:__main__:ignoring torch_compile_default_matmul-latency
INFO:__main__:ignoring helion_matmul_tritonbench-latency
INFO:tritonbench.utils.run_utils:[tritonbench] Running helion benchmark: /home/hotaisle/KernelGeneration/myenv/bin/python benchmarks/run.py --device=cuda --precision bf16 --kernel-config ../custom_kernel_config.yaml --kernel bf16_gemm_gelu --output benchmark_bf16_gemm_gelu.json
Loading custom kernel configuration from: ../custom_kernel_config.yaml
Loaded 3 kernel mapping(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Loaded metric mappings for 3 kernel(s): bf16_gemm_gelu, bf16_layernorm, bf16_matmul
Using num_inputs=20 for bf16_gemm_gelu
Running bf16_gemm_gelu benchmark with Helion implementation...

WARNING:tritonbench.utils.triton_op:First-k mode: Selected 5 sequential inputs starting from index 0 (total available: 5)
WARNING:tritonbench.utils.triton_op:Input IDs to run: [0, 1, 2, 3, 4]
  0%|          | 0/5 [00:00<?, ?it/s]WARNING:tritonbench.utils.triton_op:Running input ID 0:
(M, K, N)
------------
(32, 64, 16)
INFO:tritonbench.utils.triton_op:Took 0.01ms to get benchmark function for torch_gemm_gelu
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for mako_gemm_gelu
INFO:tritonbench.utils.triton_op:Took 0.06ms to get benchmark function for kernelllm_gemm_gelu
Autotune Choices Stats:
{"num_choices": 12, "num_triton_choices": 12, "best_kernel": "triton_mm_2", "best_kernel_desc": "ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=4, num_stages=2, num_warps=2", "best_time": 0.010262999683618546, "best_triton_pos": 0}
AUTOTUNE mm(32x64, 64x16)
strides: [64, 1], [16, 1]
dtypes: torch.bfloat16, torch.bfloat16
  triton_mm_2 0.0103 ms 100.0% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=4, num_stages=2, num_warps=2
  triton_mm_4 0.0105 ms 97.7% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=4, num_stages=2, num_warps=2
  triton_mm_3 0.0113 ms 91.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
  triton_mm_0 0.0115 ms 89.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=16, BLOCK_N=16, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=8, num_stages=2, num_warps=1
  triton_mm_8 0.0118 ms 87.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=4, num_stages=2, num_warps=2
  triton_mm_1 0.0125 ms 81.8% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=4, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
  triton_mm_9 0.0126 ms 81.5% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=4, num_stages=2, num_warps=2
  triton_mm_7 0.0138 ms 74.2% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=64, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
  triton_mm_6 0.0141 ms 72.9% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=16, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=8, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
  triton_mm_11 0.0142 ms 72.1% ACC_TYPE='tl.float32', ALLOW_TF32=False, BLOCK_K=32, BLOCK_M=32, BLOCK_N=16, EVEN_K=True, GROUP_M=16, USE_FAST_ACCUM=False, kpack=2, matrix_instr_nonkdim=16, waves_per_eu=0, num_stages=2, num_warps=2
SingleProcess AUTOTUNE benchmarking takes 0.0873 seconds and 0.1150 seconds precompiling for 12 choices
INFO:tritonbench.utils.triton_op:Took 1867.06ms to get benchmark function for torch_compile_max_gemm_gelu
INFO:tritonbench.utils.triton_op:Took 235.50ms to get benchmark function for torch_compile_default_gemm_gelu
INFO:tritonbench.utils.triton_op:Took 0.03ms to get benchmark function for triton_gemm_gelu_kernel
WARNING:__main__:Input tensor metadata:
{ 'args': ( { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (32, 64),
              'stride': (64, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (64, 16),
              'stride': (16, 1)},
            { 'device': 'cuda:0',
              'dtype': 'torch.bfloat16',
              'shape': (16,),
              'stride': (1,)}),
  'kwargs': {}}
INFO:tritonbench.utils.triton_op:Took 0.61ms to get benchmark function for helion_gemm_gelu_tritonbench
[0s] Autotune random seed: 356407725
[0s] Starting PatternSearch with initial_population=100, copies=5, max_generations=20
Initial population precompiling 100% ━━━━━━━━━━━━━━━━━━ 100/100 29.3 configs/s
Initial population exploring neighbors 100% ━━━━━━━━━━━━ 100/100 17.0         
                                                                 configs/s    
Verifying initial results 100% ━━━━━━━━━━━━━━━━━━━━━ 1000/1000 191.4 configs/s
[17s] Initial random population of 100, 5 starting points: error=14 ok=86 min=0.0075 mid=0.0130 max=0.0196 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'tensor_descriptor'], l2_groupings=[16], load_eviction_policies=['', '', 'last'], loop_orders=[[0, 1]], matrix_instr_nonkdim=0, num_stages=4, num_warps=4, pid_type='xyz', range_flattens=[None, False], range_multi_buffers=[None, True], range_num_stages=[0, 0], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[17s] Generation 1 starting: 176 neighbors, 5 active search path(s)
Generation 1: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 176/176 29.4 configs/s
Generation 1: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 176/176 15.4 configs/s
Generation 1: verifying top configs 100% ━━━━━━━━━━━━━ 1000/1000 93.6         
                                                                 configs/s    
[51s] Generation 1 complete: ok=181 min=0.0061 mid=0.0072 max=0.0207 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[51s] Generation 2 starting: 130 neighbors, 4 active search path(s)
Generation 2: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 130/130 41.6 configs/s
Generation 2: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 130/130 15.4 configs/s
Generation 2: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 127.2         
                                                                configs/s     
[74s] Generation 2 complete: ok=134 min=0.0060 mid=0.0066 max=0.0178 best=Config(block_sizes=[1, 1, 32], indexing=['pointer', 'pointer', 'pointer', 'tensor_descriptor'], l2_groupings=[4], load_eviction_policies=['first', 'last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=3, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 1], range_warp_specializes=[], waves_per_eu=1)
[74s] Generation 3 starting: 125 neighbors, 4 active search path(s)
Generation 3: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 125/125 38.3 configs/s
Generation 3: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 125/125 15.8 configs/s
Generation 3: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 132.7         
                                                                configs/s     
[96s] Generation 3 complete: ok=129 min=0.0061 mid=0.0067 max=0.0176 best=Config(block_sizes=[1, 1, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 4], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[96s] Generation 4 starting: 126 neighbors, 4 active search path(s)
Generation 4: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 126/126 40.0 configs/s
Generation 4: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 126/126 15.7 configs/s
Generation 4: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 133.9         
                                                                configs/s     
[119s] Generation 4 complete: ok=130 min=0.0060 mid=0.0066 max=0.0168 best=Config(block_sizes=[1, 1, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'tensor_descriptor', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[119s] Generation 5 starting: 127 neighbors, 4 active search path(s)
Generation 5: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 127/127 39.9 configs/s
Generation 5: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 127/127 15.7 configs/s
Generation 5: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 130.7         
                                                                configs/s     
[141s] Generation 5 complete: ok=131 min=0.0062 mid=0.0068 max=0.0181 best=Config(block_sizes=[1, 1, 32], indexing=['pointer', 'pointer', 'pointer', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[141s] Generation 6 starting: 127 neighbors, 4 active search path(s)
Generation 6: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 127/127 39.6 configs/s
Generation 6: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 127/127 15.6 configs/s
Generation 6: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 135.0         
                                                                configs/s     
[164s] Generation 6 complete: ok=131 min=0.0060 mid=0.0069 max=0.0180 best=Config(block_sizes=[1, 1, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 4], range_warp_specializes=[], waves_per_eu=1)
[164s] Generation 7 starting: 125 neighbors, 4 active search path(s)
Generation 7: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 125/125 39.8 configs/s
Generation 7: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 125/125 15.7 configs/s
Generation 7: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 132.4         
                                                                configs/s     
[186s] Generation 7 complete: ok=129 min=0.0061 mid=0.0068 max=0.0176 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[4], load_eviction_policies=['first', 'last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=2, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[186s] Generation 8 starting: 126 neighbors, 4 active search path(s)
Generation 8: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 126/126 41.7 configs/s
Generation 8: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 126/126 15.7 configs/s
Generation 8: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 133.0         
                                                                configs/s     
[208s] Generation 8 complete: ok=130 min=0.0060 mid=0.0064 max=0.0157 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[209s] Generation 9 starting: 128 neighbors, 4 active search path(s)
Generation 9: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━━ 128/128 37.8 configs/s
Generation 9: exploring neighbors 100% ━━━━━━━━━━━━━━━━ 128/128 15.5 configs/s
Generation 9: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 130.0         
                                                                configs/s     
[232s] Generation 9 complete: ok=132 min=0.0061 mid=0.0064 max=0.0170 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['first', 'last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[232s] Generation 10 starting: 126 neighbors, 4 active search path(s)
Generation 10: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 126/126 36.9 configs/s
Generation 10: exploring neighbors 100% ━━━━━━━━━━━━━━━ 126/126 15.3 configs/s
Generation 10: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 134.9        
                                                                 configs/s    
[255s] Generation 10 complete: ok=130 min=0.0060 mid=0.0065 max=0.0174 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['first', 'last', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='flat', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[255s] Generation 11 starting: 124 neighbors, 4 active search path(s)
Generation 11: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 124/124 38.7 configs/s
Generation 11: exploring neighbors 100% ━━━━━━━━━━━━━━━ 124/124 15.7 configs/s
Generation 11: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 133.3        
                                                                 configs/s    
[277s] Generation 11 complete: ok=128 min=0.0061 mid=0.0066 max=0.0167 best=Config(block_sizes=[1, 1, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 1], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[277s] Generation 12 starting: 126 neighbors, 4 active search path(s)
Generation 12: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 126/126 38.4 configs/s
Generation 12: exploring neighbors 100% ━━━━━━━━━━━━━━━ 126/126 15.8 configs/s
Generation 12: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 131.7        
                                                                 configs/s    
[300s] Generation 12 complete: ok=130 min=0.0060 mid=0.0065 max=0.0178 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['first', 'last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[300s] Generation 13 starting: 123 neighbors, 4 active search path(s)
Generation 13: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 123/123 35.8 configs/s
Generation 13: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 15.2 configs/s
Generation 13: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 136.3        
                                                                 configs/s    
[322s] Generation 13 complete: ok=127 min=0.0061 mid=0.0067 max=0.0177 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'tensor_descriptor', 'pointer'], l2_groupings=[2], load_eviction_policies=['first', 'last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 1], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[322s] Generation 14 starting: 123 neighbors, 4 active search path(s)
Generation 14: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 123/123 39.0 configs/s
Generation 14: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 15.7 configs/s
Generation 14: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 135.0        
                                                                 configs/s    
[344s] Generation 14 complete: ok=127 min=0.0060 mid=0.0067 max=0.0180 best=Config(block_sizes=[1, 1, 64], indexing=['tensor_descriptor', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[344s] Generation 15 starting: 122 neighbors, 4 active search path(s)
Generation 15: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 122/122 40.0 configs/s
Generation 15: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 15.2 configs/s
Generation 15: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 137.6        
                                                                 configs/s    
[366s] Generation 15 complete: ok=126 min=0.0061 mid=0.0067 max=0.0173 best=Config(block_sizes=[1, 1, 32], indexing=['tensor_descriptor', 'pointer', 'pointer', 'pointer'], l2_groupings=[2], load_eviction_policies=['first', 'last', 'last'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=4, num_warps=1, pid_type='flat', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 2], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[366s] Generation 16 starting: 125 neighbors, 4 active search path(s)
Generation 16: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 125/125 40.3 configs/s
Generation 16: exploring neighbors 100% ━━━━━━━━━━━━━━━ 125/125 15.6 configs/s
Generation 16: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 135.6        
                                                                 configs/s    
[388s] Generation 16 complete: ok=129 min=0.0060 mid=0.0064 max=0.0164 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, True], range_multi_buffers=[None, True], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[388s] Generation 17 starting: 121 neighbors, 4 active search path(s)
Generation 17: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 121/121 39.1 configs/s
Generation 17: exploring neighbors 100% ━━━━━━━━━━━━━━━ 121/121 15.5 configs/s
Generation 17: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 137.5        
                                                                 configs/s    
[410s] Generation 17 complete: ok=125 min=0.0061 mid=0.0065 max=0.0194 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 3], range_warp_specializes=[], waves_per_eu=1)
[410s] Generation 18 starting: 123 neighbors, 4 active search path(s)
Generation 18: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 123/123 37.1 configs/s
Generation 18: exploring neighbors 100% ━━━━━━━━━━━━━━━ 123/123 15.3 configs/s
Generation 18: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 135.7        
                                                                 configs/s    
[432s] Generation 18 complete: ok=127 min=0.0060 mid=0.0063 max=0.0159 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, True], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[432s] Generation 19 starting: 122 neighbors, 4 active search path(s)
Generation 19: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 122/122 31.6 configs/s
Generation 19: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 15.5 configs/s
Generation 19: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 136.4        
                                                                 configs/s    
[455s] Generation 19 complete: ok=126 min=0.0061 mid=0.0065 max=0.0192 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', 'first'], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[455s] Generation 20 starting: 122 neighbors, 4 active search path(s)
Generation 20: precompiling 100% ━━━━━━━━━━━━━━━━━━━━━━ 122/122 31.9 configs/s
Generation 20: exploring neighbors 100% ━━━━━━━━━━━━━━━ 122/122 15.5 configs/s
Generation 20: verifying top configs 100% ━━━━━━━━━━━━ 1000/1000 138.7        
                                                                 configs/s    
[478s] Generation 20 complete: ok=126 min=0.0060 mid=0.0065 max=0.0165 best=Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1)
[478s] Autotuning complete in 478.7s after searching 2647 configs.
One can hardcode the best config and skip autotuning with:
    @helion.kernel(config=helion.Config(block_sizes=[1, 1, 64], indexing=['pointer', 'tensor_descriptor', 'pointer', 'pointer'], l2_groupings=[64], load_eviction_policies=['last', '', ''], loop_orders=[[1, 0]], matrix_instr_nonkdim=0, num_stages=8, num_warps=1, pid_type='xyz', range_flattens=[None, False], range_multi_buffers=[None, None], range_num_stages=[0, 3], range_unroll_factors=[0, 2], range_warp_specializes=[], waves_per_eu=1), static_shapes=True)

  0%|          | 0/5 [08:10<?, ?it/s]
WARNING:tritonbench.utils.triton_op:Caught exception on backend helion_gemm_gelu_tritonbench, terminating early with partial results
Traceback (most recent call last):
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1149, in run
    y_vals: Dict[str, BenchmarkOperatorMetrics] = functools.reduce(
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1130, in _reduce_benchmarks
    acc[bm_name] = self._do_bench(
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/utils/triton_op.py", line 1783, in _do_bench
    self.accuracy(fn, self.baseline_fn) if self.baseline_fn else None
  File "/home/hotaisle/KernelGeneration/tritonbench/tritonbench/operators/bf16_gemm_gelu/operator.py", line 133, in accuracy
    assert result, "Outputs are not close!"
AssertionError: Outputs are not close!
WARNING:tritonbench.utils.triton_op:Failing input: --input-id 0 --num-inputs 1 --input-sample-mode first-k
INFO:tritonbench.utils.run_utils:[tritonbench] Output result csv to /tmp/tmpv_vea7sz.csv
  (M, K, N)
-----------
INFO:__main__:Benchmark run completed
INFO:__main__:Post-processing 3 output file(s)...
INFO:__main__:Processing output for benchmark 'bf16_layernorm': benchmark_bf16_layernorm.json
INFO:__main__:Processing results from: /home/hotaisle/KernelGeneration/helion/benchmark_bf16_layernorm.json
INFO:__main__:Successfully moved output to: /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_layernorm_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
INFO:__main__:Processing output for benchmark 'bf16_matmul': benchmark_bf16_matmul.json
INFO:__main__:Processing results from: /home/hotaisle/KernelGeneration/helion/benchmark_bf16_matmul.json
INFO:__main__:Successfully moved output to: /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_matmul_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
INFO:__main__:Processing output for benchmark 'bf16_gemm_gelu': benchmark_bf16_gemm_gelu.json
INFO:__main__:Processing results from: /home/hotaisle/KernelGeneration/helion/benchmark_bf16_gemm_gelu.json
INFO:__main__:Successfully moved output to: /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_gemm_gelu_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
INFO:__main__:==================================================
INFO:__main__:POST-PROCESSING SUMMARY
INFO:__main__:==================================================
INFO:__main__:Total: 3 | Success: 3 | Failed: 0
INFO:__main__:Successful:
INFO:__main__:  ✓ bf16_layernorm -> /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_layernorm_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
INFO:__main__:  ✓ bf16_matmul -> /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_matmul_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
INFO:__main__:  ✓ bf16_gemm_gelu -> /home/hotaisle/KernelGeneration/results/AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-_20251212_211119/benchmark_bf16_gemm_gelu_AMD_Instinct_MI300X_VF_gfx942_sramecc_xnack-.json
